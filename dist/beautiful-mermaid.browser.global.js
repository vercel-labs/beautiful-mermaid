var beautifulMermaid=(function(exports){'use strict';var qn=Object.create;var Gt=Object.defineProperty;var Kn=Object.getOwnPropertyDescriptor;var Jn=Object.getOwnPropertyNames;var Zn=Object.getPrototypeOf,Qn=Object.prototype.hasOwnProperty;var Be=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,r)=>(typeof require<"u"?require:n)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var er=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var tr=(e,n,r,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of Jn(n))!Qn.call(e,o)&&o!==r&&Gt(e,o,{get:()=>n[o],enumerable:!(t=Kn(n,o))||t.enumerable});return e};var ut=(e,n,r)=>(r=e!=null?qn(Zn(e)):{},tr(Gt(r,"default",{value:e,enumerable:true}),e));var st=er((fn,Mt)=>{(function(e){if(typeof fn=="object"&&typeof Mt<"u")Mt.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else {var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.dagre=e();}})(function(){return (function(){function t(o,i,c){function a(d,u){if(!i[d]){if(!o[d]){var s=typeof Be=="function"&&Be;if(!u&&s)return s(d,true);if(l)return l(d,true);var f=new Error("Cannot find module '"+d+"'");throw f.code="MODULE_NOT_FOUND",f}var p=i[d]={exports:{}};o[d][0].call(p.exports,function(x){var g=o[d][1][x];return a(g||x)},p,p.exports,t,o,i,c);}return i[d].exports}for(var l=typeof Be=="function"&&Be,h=0;h<c.length;h++)a(c[h]);return a}return t})()({1:[function(t,o,i){o.exports={graphlib:t("@dagrejs/graphlib"),layout:t("./lib/layout"),debug:t("./lib/debug"),util:{time:t("./lib/util").time,notime:t("./lib/util").notime},version:t("./lib/version")};},{"./lib/debug":6,"./lib/layout":8,"./lib/util":27,"./lib/version":28,"@dagrejs/graphlib":29}],2:[function(t,o,i){let c=t("./greedy-fas"),a=t("./util").uniqueId;o.exports={run:l,undo:d};function l(u){(u.graph().acyclicer==="greedy"?c(u,f(u)):h(u)).forEach(p=>{let x=u.edge(p);u.removeEdge(p),x.forwardName=p.name,x.reversed=true,u.setEdge(p.w,p.v,x,a("rev"));});function f(p){return x=>p.edge(x).weight}}function h(u){let s=[],f={},p={};function x(g){Object.hasOwn(p,g)||(p[g]=true,f[g]=true,u.outEdges(g).forEach(m=>{Object.hasOwn(f,m.w)?s.push(m):x(m.w);}),delete f[g]);}return u.nodes().forEach(x),s}function d(u){u.edges().forEach(s=>{let f=u.edge(s);if(f.reversed){u.removeEdge(s);let p=f.forwardName;delete f.reversed,delete f.forwardName,u.setEdge(s.w,s.v,f,p);}});}},{"./greedy-fas":7,"./util":27}],3:[function(t,o,i){let c=t("./util");o.exports=a;function a(h){function d(u){let s=h.children(u),f=h.node(u);if(s.length&&s.forEach(d),Object.hasOwn(f,"minRank")){f.borderLeft=[],f.borderRight=[];for(let p=f.minRank,x=f.maxRank+1;p<x;++p)l(h,"borderLeft","_bl",u,f,p),l(h,"borderRight","_br",u,f,p);}}h.children().forEach(d);}function l(h,d,u,s,f,p){let x={width:0,height:0,rank:p,borderType:d},g=f[d][p-1],m=c.addDummyNode(h,"border",x,u);f[d][p]=m,h.setParent(m,s),g&&h.setEdge(g,m,{weight:1});}},{"./util":27}],4:[function(t,o,i){o.exports={adjust:c,undo:a};function c(p){let x=p.graph().rankdir.toLowerCase();(x==="lr"||x==="rl")&&l(p);}function a(p){let x=p.graph().rankdir.toLowerCase();(x==="bt"||x==="rl")&&d(p),(x==="lr"||x==="rl")&&(s(p),l(p));}function l(p){p.nodes().forEach(x=>h(p.node(x))),p.edges().forEach(x=>h(p.edge(x)));}function h(p){let x=p.width;p.width=p.height,p.height=x;}function d(p){p.nodes().forEach(x=>u(p.node(x))),p.edges().forEach(x=>{let g=p.edge(x);g.points.forEach(u),Object.hasOwn(g,"y")&&u(g);});}function u(p){p.y=-p.y;}function s(p){p.nodes().forEach(x=>f(p.node(x))),p.edges().forEach(x=>{let g=p.edge(x);g.points.forEach(f),Object.hasOwn(g,"x")&&f(g);});}function f(p){let x=p.x;p.x=p.y,p.y=x;}},{}],5:[function(t,o,i){class c{constructor(){let d={};d._next=d._prev=d,this._sentinel=d;}dequeue(){let d=this._sentinel,u=d._prev;if(u!==d)return a(u),u}enqueue(d){let u=this._sentinel;d._prev&&d._next&&a(d),d._next=u._next,u._next._prev=d,u._next=d,d._prev=u;}toString(){let d=[],u=this._sentinel,s=u._prev;for(;s!==u;)d.push(JSON.stringify(s,l)),s=s._prev;return "["+d.join(", ")+"]"}}function a(h){h._prev._next=h._next,h._next._prev=h._prev,delete h._next,delete h._prev;}function l(h,d){if(h!=="_next"&&h!=="_prev")return d}o.exports=c;},{}],6:[function(t,o,i){let c=t("./util"),a=t("@dagrejs/graphlib").Graph;o.exports={debugOrdering:l};function l(h){let d=c.buildLayerMatrix(h),u=new a({compound:true,multigraph:true}).setGraph({});return h.nodes().forEach(s=>{u.setNode(s,{label:s}),u.setParent(s,"layer"+h.node(s).rank);}),h.edges().forEach(s=>u.setEdge(s.v,s.w,{},s.name)),d.forEach((s,f)=>{let p="layer"+f;u.setNode(p,{rank:"same"}),s.reduce((x,g)=>(u.setEdge(x,g,{style:"invis"}),g));}),u}},{"./util":27,"@dagrejs/graphlib":29}],7:[function(t,o,i){let c=t("@dagrejs/graphlib").Graph,a=t("./data/list");o.exports=h;let l=()=>1;function h(x,g){if(x.nodeCount()<=1)return [];let m=s(x,g||l);return d(m.graph,m.buckets,m.zeroIdx).flatMap($=>x.outEdges($.v,$.w))}function d(x,g,m){let v=[],$=g[g.length-1],M=g[0],L;for(;x.nodeCount();){for(;L=M.dequeue();)u(x,g,m,L);for(;L=$.dequeue();)u(x,g,m,L);if(x.nodeCount()){for(let y=g.length-2;y>0;--y)if(L=g[y].dequeue(),L){v=v.concat(u(x,g,m,L,true));break}}}return v}function u(x,g,m,v,$){let M=$?[]:void 0;return x.inEdges(v.v).forEach(L=>{let y=x.edge(L),b=x.node(L.v);$&&M.push({v:L.v,w:L.w}),b.out-=y,f(g,m,b);}),x.outEdges(v.v).forEach(L=>{let y=x.edge(L),b=L.w,w=x.node(b);w.in-=y,f(g,m,w);}),x.removeNode(v.v),M}function s(x,g){let m=new c,v=0,$=0;x.nodes().forEach(y=>{m.setNode(y,{v:y,in:0,out:0});}),x.edges().forEach(y=>{let b=m.edge(y.v,y.w)||0,w=g(y),E=b+w;m.setEdge(y.v,y.w,E),$=Math.max($,m.node(y.v).out+=w),v=Math.max(v,m.node(y.w).in+=w);});let M=p($+v+3).map(()=>new a),L=v+1;return m.nodes().forEach(y=>{f(M,L,m.node(y));}),{graph:m,buckets:M,zeroIdx:L}}function f(x,g,m){m.out?m.in?x[m.out-m.in+g].enqueue(m):x[x.length-1].enqueue(m):x[0].enqueue(m);}function p(x){let g=[];for(let m=0;m<x;m++)g.push(m);return g}},{"./data/list":5,"@dagrejs/graphlib":29}],8:[function(t,o,i){let c=t("./acyclic"),a=t("./normalize"),l=t("./rank"),h=t("./util").normalizeRanks,d=t("./parent-dummy-chains"),u=t("./util").removeEmptyRanks,s=t("./nesting-graph"),f=t("./add-border-segments"),p=t("./coordinate-system"),x=t("./order"),g=t("./position"),m=t("./util"),v=t("@dagrejs/graphlib").Graph;o.exports=$;function $(_,D){let N=D&&D.debugTiming?m.time:m.notime;N("layout",()=>{let z=N("  buildLayoutGraph",()=>k(_));N("  runLayout",()=>M(z,N,D)),N("  updateInputGraph",()=>L(_,z));});}function M(_,D,N){D("    makeSpaceForEdgeLabels",()=>S(_)),D("    removeSelfEdges",()=>X(_)),D("    acyclic",()=>c.run(_)),D("    nestingGraph.run",()=>s.run(_)),D("    rank",()=>l(m.asNonCompoundGraph(_))),D("    injectEdgeLabelProxies",()=>T(_)),D("    removeEmptyRanks",()=>u(_)),D("    nestingGraph.cleanup",()=>s.cleanup(_)),D("    normalizeRanks",()=>h(_)),D("    assignRankMinMax",()=>A(_)),D("    removeEdgeLabelProxies",()=>C(_)),D("    normalize.run",()=>a.run(_)),D("    parentDummyChains",()=>d(_)),D("    addBorderSegments",()=>f(_)),D("    order",()=>x(_,N)),D("    insertSelfEdges",()=>Y(_)),D("    adjustCoordinateSystem",()=>p.adjust(_)),D("    position",()=>g(_)),D("    positionSelfEdges",()=>H(_)),D("    removeBorderNodes",()=>B(_)),D("    normalize.undo",()=>a.undo(_)),D("    fixupEdgeLabelCoords",()=>P(_)),D("    undoCoordinateSystem",()=>p.undo(_)),D("    translateGraph",()=>W(_)),D("    assignNodeIntersects",()=>U(_)),D("    reversePoints",()=>j(_)),D("    acyclic.undo",()=>c.undo(_));}function L(_,D){_.nodes().forEach(N=>{let z=_.node(N),K=D.node(N);z&&(z.x=K.x,z.y=K.y,z.rank=K.rank,D.children(N).length&&(z.width=K.width,z.height=K.height));}),_.edges().forEach(N=>{let z=_.edge(N),K=D.edge(N);z.points=K.points,Object.hasOwn(K,"x")&&(z.x=K.x,z.y=K.y);}),_.graph().width=D.graph().width,_.graph().height=D.graph().height;}let y=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],E=["width","height","rank"],G={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],I={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},R=["labelpos"];function k(_){let D=new v({multigraph:true,compound:true}),N=V(_.graph());return D.setGraph(Object.assign({},b,F(N,y),m.pick(N,w))),_.nodes().forEach(z=>{let K=V(_.node(z)),ee=F(K,E);Object.keys(G).forEach(J=>{ee[J]===void 0&&(ee[J]=G[J]);}),D.setNode(z,ee),D.setParent(z,_.parent(z));}),_.edges().forEach(z=>{let K=V(_.edge(z));D.setEdge(z,Object.assign({},I,F(K,O),m.pick(K,R)));}),D}function S(_){let D=_.graph();D.ranksep/=2,_.edges().forEach(N=>{let z=_.edge(N);z.minlen*=2,z.labelpos.toLowerCase()!=="c"&&(D.rankdir==="TB"||D.rankdir==="BT"?z.width+=z.labeloffset:z.height+=z.labeloffset);});}function T(_){_.edges().forEach(D=>{let N=_.edge(D);if(N.width&&N.height){let z=_.node(D.v),ee={rank:(_.node(D.w).rank-z.rank)/2+z.rank,e:D};m.addDummyNode(_,"edge-proxy",ee,"_ep");}});}function A(_){let D=0;_.nodes().forEach(N=>{let z=_.node(N);z.borderTop&&(z.minRank=_.node(z.borderTop).rank,z.maxRank=_.node(z.borderBottom).rank,D=Math.max(D,z.maxRank));}),_.graph().maxRank=D;}function C(_){_.nodes().forEach(D=>{let N=_.node(D);N.dummy==="edge-proxy"&&(_.edge(N.e).labelRank=N.rank,_.removeNode(D));});}function W(_){let D=Number.POSITIVE_INFINITY,N=0,z=Number.POSITIVE_INFINITY,K=0,ee=_.graph(),J=ee.marginx||0,ce=ee.marginy||0;function fe(pe){let ue=pe.x,Xe=pe.y,It=pe.width,Nt=pe.height;D=Math.min(D,ue-It/2),N=Math.max(N,ue+It/2),z=Math.min(z,Xe-Nt/2),K=Math.max(K,Xe+Nt/2);}_.nodes().forEach(pe=>fe(_.node(pe))),_.edges().forEach(pe=>{let ue=_.edge(pe);Object.hasOwn(ue,"x")&&fe(ue);}),D-=J,z-=ce,_.nodes().forEach(pe=>{let ue=_.node(pe);ue.x-=D,ue.y-=z;}),_.edges().forEach(pe=>{let ue=_.edge(pe);ue.points.forEach(Xe=>{Xe.x-=D,Xe.y-=z;}),Object.hasOwn(ue,"x")&&(ue.x-=D),Object.hasOwn(ue,"y")&&(ue.y-=z);}),ee.width=N-D+J,ee.height=K-z+ce;}function U(_){_.edges().forEach(D=>{let N=_.edge(D),z=_.node(D.v),K=_.node(D.w),ee,J;N.points?(ee=N.points[0],J=N.points[N.points.length-1]):(N.points=[],ee=K,J=z),N.points.unshift(m.intersectRect(z,ee)),N.points.push(m.intersectRect(K,J));});}function P(_){_.edges().forEach(D=>{let N=_.edge(D);if(Object.hasOwn(N,"x"))switch((N.labelpos==="l"||N.labelpos==="r")&&(N.width-=N.labeloffset),N.labelpos){case "l":N.x-=N.width/2+N.labeloffset;break;case "r":N.x+=N.width/2+N.labeloffset;break}});}function j(_){_.edges().forEach(D=>{let N=_.edge(D);N.reversed&&N.points.reverse();});}function B(_){_.nodes().forEach(D=>{if(_.children(D).length){let N=_.node(D),z=_.node(N.borderTop),K=_.node(N.borderBottom),ee=_.node(N.borderLeft[N.borderLeft.length-1]),J=_.node(N.borderRight[N.borderRight.length-1]);N.width=Math.abs(J.x-ee.x),N.height=Math.abs(K.y-z.y),N.x=ee.x+N.width/2,N.y=z.y+N.height/2;}}),_.nodes().forEach(D=>{_.node(D).dummy==="border"&&_.removeNode(D);});}function X(_){_.edges().forEach(D=>{if(D.v===D.w){var N=_.node(D.v);N.selfEdges||(N.selfEdges=[]),N.selfEdges.push({e:D,label:_.edge(D)}),_.removeEdge(D);}});}function Y(_){var D=m.buildLayerMatrix(_);D.forEach(N=>{var z=0;N.forEach((K,ee)=>{var J=_.node(K);J.order=ee+z,(J.selfEdges||[]).forEach(ce=>{m.addDummyNode(_,"selfedge",{width:ce.label.width,height:ce.label.height,rank:J.rank,order:ee+ ++z,e:ce.e,label:ce.label},"_se");}),delete J.selfEdges;});});}function H(_){_.nodes().forEach(D=>{var N=_.node(D);if(N.dummy==="selfedge"){var z=_.node(N.e.v),K=z.x+z.width/2,ee=z.y,J=N.x-K,ce=z.height/2;_.setEdge(N.e,N.label),_.removeNode(D),N.label.points=[{x:K+2*J/3,y:ee-ce},{x:K+5*J/6,y:ee-ce},{x:K+J,y:ee},{x:K+5*J/6,y:ee+ce},{x:K+2*J/3,y:ee+ce}],N.label.x=N.x,N.label.y=N.y;}});}function F(_,D){return m.mapValues(m.pick(_,D),Number)}function V(_){var D={};return _&&Object.entries(_).forEach(([N,z])=>{typeof N=="string"&&(N=N.toLowerCase()),D[N]=z;}),D}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./nesting-graph":9,"./normalize":10,"./order":15,"./parent-dummy-chains":20,"./position":22,"./rank":24,"./util":27,"@dagrejs/graphlib":29}],9:[function(t,o,i){let c=t("./util");o.exports={run:a,cleanup:u};function a(s){let f=c.addDummyNode(s,"root",{},"_root"),p=h(s),x=Object.values(p),g=c.applyWithChunking(Math.max,x)-1,m=2*g+1;s.graph().nestingRoot=f,s.edges().forEach($=>s.edge($).minlen*=m);let v=d(s)+1;s.children().forEach($=>l(s,f,m,v,g,p,$)),s.graph().nodeRankFactor=m;}function l(s,f,p,x,g,m,v){let $=s.children(v);if(!$.length){v!==f&&s.setEdge(f,v,{weight:0,minlen:p});return}let M=c.addBorderNode(s,"_bt"),L=c.addBorderNode(s,"_bb"),y=s.node(v);s.setParent(M,v),y.borderTop=M,s.setParent(L,v),y.borderBottom=L,$.forEach(b=>{l(s,f,p,x,g,m,b);let w=s.node(b),E=w.borderTop?w.borderTop:b,G=w.borderBottom?w.borderBottom:b,O=w.borderTop?x:2*x,I=E!==G?1:g-m[v]+1;s.setEdge(M,E,{weight:O,minlen:I,nestingEdge:true}),s.setEdge(G,L,{weight:O,minlen:I,nestingEdge:true});}),s.parent(v)||s.setEdge(f,M,{weight:0,minlen:g+m[v]});}function h(s){var f={};function p(x,g){var m=s.children(x);m&&m.length&&m.forEach(v=>p(v,g+1)),f[x]=g;}return s.children().forEach(x=>p(x,1)),f}function d(s){return s.edges().reduce((f,p)=>f+s.edge(p).weight,0)}function u(s){var f=s.graph();s.removeNode(f.nestingRoot),delete f.nestingRoot,s.edges().forEach(p=>{var x=s.edge(p);x.nestingEdge&&s.removeEdge(p);});}},{"./util":27}],10:[function(t,o,i){let c=t("./util");o.exports={run:a,undo:h};function a(d){d.graph().dummyChains=[],d.edges().forEach(u=>l(d,u));}function l(d,u){let s=u.v,f=d.node(s).rank,p=u.w,x=d.node(p).rank,g=u.name,m=d.edge(u),v=m.labelRank;if(x===f+1)return;d.removeEdge(u);let $,M,L;for(L=0,++f;f<x;++L,++f)m.points=[],M={width:0,height:0,edgeLabel:m,edgeObj:u,rank:f},$=c.addDummyNode(d,"edge",M,"_d"),f===v&&(M.width=m.width,M.height=m.height,M.dummy="edge-label",M.labelpos=m.labelpos),d.setEdge(s,$,{weight:m.weight},g),L===0&&d.graph().dummyChains.push($),s=$;d.setEdge(s,p,{weight:m.weight},g);}function h(d){d.graph().dummyChains.forEach(u=>{let s=d.node(u),f=s.edgeLabel,p;for(d.setEdge(s.edgeObj,f);s.dummy;)p=d.successors(u)[0],d.removeNode(u),f.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(f.x=s.x,f.y=s.y,f.width=s.width,f.height=s.height),u=p,s=d.node(u);});}},{"./util":27}],11:[function(t,o,i){o.exports=c;function c(a,l,h){let d={},u;h.forEach(s=>{let f=a.parent(s),p,x;for(;f;){if(p=a.parent(f),p?(x=d[p],d[p]=f):(x=u,u=f),x&&x!==f){l.setEdge(x,f);return}f=p;}});}},{}],12:[function(t,o,i){o.exports=c;function c(a,l=[]){return l.map(h=>{let d=a.inEdges(h);if(d.length){let u=d.reduce((s,f)=>{let p=a.edge(f),x=a.node(f.v);return {sum:s.sum+p.weight*x.order,weight:s.weight+p.weight}},{sum:0,weight:0});return {v:h,barycenter:u.sum/u.weight,weight:u.weight}}else return {v:h}})}},{}],13:[function(t,o,i){let c=t("@dagrejs/graphlib").Graph,a=t("../util");o.exports=l;function l(d,u,s,f){f||(f=d.nodes());let p=h(d),x=new c({compound:true}).setGraph({root:p}).setDefaultNodeLabel(g=>d.node(g));return f.forEach(g=>{let m=d.node(g),v=d.parent(g);(m.rank===u||m.minRank<=u&&u<=m.maxRank)&&(x.setNode(g),x.setParent(g,v||p),d[s](g).forEach($=>{let M=$.v===g?$.w:$.v,L=x.edge(M,g),y=L!==void 0?L.weight:0;x.setEdge(M,g,{weight:d.edge($).weight+y});}),Object.hasOwn(m,"minRank")&&x.setNode(g,{borderLeft:m.borderLeft[u],borderRight:m.borderRight[u]}));}),x}function h(d){for(var u;d.hasNode(u=a.uniqueId("_root")););return u}},{"../util":27,"@dagrejs/graphlib":29}],14:[function(t,o,i){let c=t("../util").zipObject;o.exports=a;function a(h,d){let u=0;for(let s=1;s<d.length;++s)u+=l(h,d[s-1],d[s]);return u}function l(h,d,u){let s=c(u,u.map((v,$)=>$)),f=d.flatMap(v=>h.outEdges(v).map($=>({pos:s[$.w],weight:h.edge($).weight})).sort(($,M)=>$.pos-M.pos)),p=1;for(;p<u.length;)p<<=1;let x=2*p-1;p-=1;let g=new Array(x).fill(0),m=0;return f.forEach(v=>{let $=v.pos+p;g[$]+=v.weight;let M=0;for(;$>0;)$%2&&(M+=g[$+1]),$=$-1>>1,g[$]+=v.weight;m+=v.weight*M;}),m}},{"../util":27}],15:[function(t,o,i){let c=t("./init-order"),a=t("./cross-count"),l=t("./sort-subgraph"),h=t("./build-layer-graph"),d=t("./add-subgraph-constraints"),u=t("@dagrejs/graphlib").Graph,s=t("../util");o.exports=f;function f(m,v){if(v&&typeof v.customOrder=="function"){v.customOrder(m,f);return}let $=s.maxRank(m),M=p(m,s.range(1,$+1),"inEdges"),L=p(m,s.range($-1,-1,-1),"outEdges"),y=c(m);if(g(m,y),v&&v.disableOptimalOrderHeuristic)return;let b=Number.POSITIVE_INFINITY,w;for(let E=0,G=0;G<4;++E,++G){x(E%2?M:L,E%4>=2),y=s.buildLayerMatrix(m);let O=a(m,y);O<b&&(G=0,w=Object.assign({},y),b=O);}g(m,w);}function p(m,v,$){let M=new Map,L=(y,b)=>{M.has(y)||M.set(y,[]),M.get(y).push(b);};for(let y of m.nodes()){let b=m.node(y);if(typeof b.rank=="number"&&L(b.rank,y),typeof b.minRank=="number"&&typeof b.maxRank=="number")for(let w=b.minRank;w<=b.maxRank;w++)w!==b.rank&&L(w,y);}return v.map(function(y){return h(m,y,$,M.get(y)||[])})}function x(m,v){let $=new u;m.forEach(function(M){let L=M.graph().root,y=l(M,L,$,v);y.vs.forEach((b,w)=>M.node(b).order=w),d(M,$,y.vs);});}function g(m,v){Object.values(v).forEach($=>$.forEach((M,L)=>m.node(M).order=L));}},{"../util":27,"./add-subgraph-constraints":11,"./build-layer-graph":13,"./cross-count":14,"./init-order":16,"./sort-subgraph":18,"@dagrejs/graphlib":29}],16:[function(t,o,i){let c=t("../util");o.exports=a;function a(l){let h={},d=l.nodes().filter(g=>!l.children(g).length),u=d.map(g=>l.node(g).rank),s=c.applyWithChunking(Math.max,u),f=c.range(s+1).map(()=>[]);function p(g){if(h[g])return;h[g]=true;let m=l.node(g);f[m.rank].push(g),l.successors(g).forEach(p);}return d.sort((g,m)=>l.node(g).rank-l.node(m).rank).forEach(p),f}},{"../util":27}],17:[function(t,o,i){let c=t("../util");o.exports=a;function a(d,u){let s={};d.forEach((p,x)=>{let g=s[p.v]={indegree:0,in:[],out:[],vs:[p.v],i:x};p.barycenter!==void 0&&(g.barycenter=p.barycenter,g.weight=p.weight);}),u.edges().forEach(p=>{let x=s[p.v],g=s[p.w];x!==void 0&&g!==void 0&&(g.indegree++,x.out.push(s[p.w]));});let f=Object.values(s).filter(p=>!p.indegree);return l(f)}function l(d){let u=[];function s(p){return x=>{x.merged||(x.barycenter===void 0||p.barycenter===void 0||x.barycenter>=p.barycenter)&&h(p,x);}}function f(p){return x=>{x.in.push(p),--x.indegree===0&&d.push(x);}}for(;d.length;){let p=d.pop();u.push(p),p.in.reverse().forEach(s(p)),p.out.forEach(f(p));}return u.filter(p=>!p.merged).map(p=>c.pick(p,["vs","i","barycenter","weight"]))}function h(d,u){let s=0,f=0;d.weight&&(s+=d.barycenter*d.weight,f+=d.weight),u.weight&&(s+=u.barycenter*u.weight,f+=u.weight),d.vs=u.vs.concat(d.vs),d.barycenter=s/f,d.weight=f,d.i=Math.min(u.i,d.i),u.merged=true;}},{"../util":27}],18:[function(t,o,i){let c=t("./barycenter"),a=t("./resolve-conflicts"),l=t("./sort");o.exports=h;function h(s,f,p,x){let g=s.children(f),m=s.node(f),v=m?m.borderLeft:void 0,$=m?m.borderRight:void 0,M={};v&&(g=g.filter(w=>w!==v&&w!==$));let L=c(s,g);L.forEach(w=>{if(s.children(w.v).length){let E=h(s,w.v,p,x);M[w.v]=E,Object.hasOwn(E,"barycenter")&&u(w,E);}});let y=a(L,p);d(y,M);let b=l(y,x);if(v&&(b.vs=[v,b.vs,$].flat(true),s.predecessors(v).length)){let w=s.node(s.predecessors(v)[0]),E=s.node(s.predecessors($)[0]);Object.hasOwn(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+w.order+E.order)/(b.weight+2),b.weight+=2;}return b}function d(s,f){s.forEach(p=>{p.vs=p.vs.flatMap(x=>f[x]?f[x].vs:x);});}function u(s,f){s.barycenter!==void 0?(s.barycenter=(s.barycenter*s.weight+f.barycenter*f.weight)/(s.weight+f.weight),s.weight+=f.weight):(s.barycenter=f.barycenter,s.weight=f.weight);}},{"./barycenter":12,"./resolve-conflicts":17,"./sort":19}],19:[function(t,o,i){let c=t("../util");o.exports=a;function a(d,u){let s=c.partition(d,M=>Object.hasOwn(M,"barycenter")),f=s.lhs,p=s.rhs.sort((M,L)=>L.i-M.i),x=[],g=0,m=0,v=0;f.sort(h(!!u)),v=l(x,p,v),f.forEach(M=>{v+=M.vs.length,x.push(M.vs),g+=M.barycenter*M.weight,m+=M.weight,v=l(x,p,v);});let $={vs:x.flat(true)};return m&&($.barycenter=g/m,$.weight=m),$}function l(d,u,s){let f;for(;u.length&&(f=u[u.length-1]).i<=s;)u.pop(),d.push(f.vs),s++;return s}function h(d){return (u,s)=>u.barycenter<s.barycenter?-1:u.barycenter>s.barycenter?1:d?s.i-u.i:u.i-s.i}},{"../util":27}],20:[function(t,o,i){o.exports=c;function c(h){let d=l(h);h.graph().dummyChains.forEach(u=>{let s=h.node(u),f=s.edgeObj,p=a(h,d,f.v,f.w),x=p.path,g=p.lca,m=0,v=x[m],$=true;for(;u!==f.w;){if(s=h.node(u),$){for(;(v=x[m])!==g&&h.node(v).maxRank<s.rank;)m++;v===g&&($=false);}if(!$){for(;m<x.length-1&&h.node(v=x[m+1]).minRank<=s.rank;)m++;v=x[m];}h.setParent(u,v),u=h.successors(u)[0];}});}function a(h,d,u,s){let f=[],p=[],x=Math.min(d[u].low,d[s].low),g=Math.max(d[u].lim,d[s].lim),m,v;m=u;do m=h.parent(m),f.push(m);while(m&&(d[m].low>x||g>d[m].lim));for(v=m,m=s;(m=h.parent(m))!==v;)p.push(m);return {path:f.concat(p.reverse()),lca:v}}function l(h){let d={},u=0;function s(f){let p=u;h.children(f).forEach(s),d[f]={low:p,lim:u++};}return h.children().forEach(s),d}},{}],21:[function(t,o,i){let c=t("@dagrejs/graphlib").Graph,a=t("../util");o.exports={positionX:$,findType1Conflicts:l,findType2Conflicts:h,addConflict:u,hasConflict:s,verticalAlignment:f,horizontalCompaction:p,alignCoordinates:m,findSmallestWidthAlignment:g,balance:v};function l(y,b){let w={};function E(G,O){let I=0,R=0,k=G.length,S=O[O.length-1];return O.forEach((T,A)=>{let C=d(y,T),W=C?y.node(C).order:k;(C||T===S)&&(O.slice(R,A+1).forEach(U=>{y.predecessors(U).forEach(P=>{let j=y.node(P),B=j.order;(B<I||W<B)&&!(j.dummy&&y.node(U).dummy)&&u(w,P,U);});}),R=A+1,I=W);}),O}return b.length&&b.reduce(E),w}function h(y,b){let w={};function E(O,I,R,k,S){let T;a.range(I,R).forEach(A=>{T=O[A],y.node(T).dummy&&y.predecessors(T).forEach(C=>{let W=y.node(C);W.dummy&&(W.order<k||W.order>S)&&u(w,C,T);});});}function G(O,I){let R=-1,k,S=0;return I.forEach((T,A)=>{if(y.node(T).dummy==="border"){let C=y.predecessors(T);C.length&&(k=y.node(C[0]).order,E(I,S,A,R,k),S=A,R=k);}E(I,S,I.length,k,O.length);}),I}return b.length&&b.reduce(G),w}function d(y,b){if(y.node(b).dummy)return y.predecessors(b).find(w=>y.node(w).dummy)}function u(y,b,w){if(b>w){let G=b;b=w,w=G;}let E=y[b];E||(y[b]=E={}),E[w]=true;}function s(y,b,w){if(b>w){let E=b;b=w,w=E;}return !!y[b]&&Object.hasOwn(y[b],w)}function f(y,b,w,E){let G={},O={},I={};return b.forEach(R=>{R.forEach((k,S)=>{G[k]=k,O[k]=k,I[k]=S;});}),b.forEach(R=>{let k=-1;R.forEach(S=>{let T=E(S);if(T.length){T=T.sort((C,W)=>I[C]-I[W]);let A=(T.length-1)/2;for(let C=Math.floor(A),W=Math.ceil(A);C<=W;++C){let U=T[C];O[S]===S&&k<I[U]&&!s(w,S,U)&&(O[U]=S,O[S]=G[S]=G[U],k=I[U]);}}});}),{root:G,align:O}}function p(y,b,w,E,G){let O={},I=x(y,b,w,G),R=G?"borderLeft":"borderRight";function k(A,C){let W=I.nodes(),U=W.pop(),P={};for(;U;)P[U]?A(U):(P[U]=true,W.push(U),W=W.concat(C(U))),U=W.pop();}function S(A){O[A]=I.inEdges(A).reduce((C,W)=>Math.max(C,O[W.v]+I.edge(W)),0);}function T(A){let C=I.outEdges(A).reduce((U,P)=>Math.min(U,O[P.w]-I.edge(P)),Number.POSITIVE_INFINITY),W=y.node(A);C!==Number.POSITIVE_INFINITY&&W.borderType!==R&&(O[A]=Math.max(O[A],C));}return k(S,I.predecessors.bind(I)),k(T,I.successors.bind(I)),Object.keys(E).forEach(A=>O[A]=O[w[A]]),O}function x(y,b,w,E){let G=new c,O=y.graph(),I=M(O.nodesep,O.edgesep,E);return b.forEach(R=>{let k;R.forEach(S=>{let T=w[S];if(G.setNode(T),k){var A=w[k],C=G.edge(A,T);G.setEdge(A,T,Math.max(I(y,S,k),C||0));}k=S;});}),G}function g(y,b){return Object.values(b).reduce((w,E)=>{let G=Number.NEGATIVE_INFINITY,O=Number.POSITIVE_INFINITY;Object.entries(E).forEach(([R,k])=>{let S=L(y,R)/2;G=Math.max(k+S,G),O=Math.min(k-S,O);});let I=G-O;return I<w[0]&&(w=[I,E]),w},[Number.POSITIVE_INFINITY,null])[1]}function m(y,b){let w=Object.values(b),E=a.applyWithChunking(Math.min,w),G=a.applyWithChunking(Math.max,w);["u","d"].forEach(O=>{["l","r"].forEach(I=>{let R=O+I,k=y[R];if(k===b)return;let S=Object.values(k),T=E-a.applyWithChunking(Math.min,S);I!=="l"&&(T=G-a.applyWithChunking(Math.max,S)),T&&(y[R]=a.mapValues(k,A=>A+T));});});}function v(y,b){return a.mapValues(y.ul,(w,E)=>{if(b)return y[b.toLowerCase()][E];{let G=Object.values(y).map(O=>O[E]).sort((O,I)=>O-I);return (G[1]+G[2])/2}})}function $(y){let b=a.buildLayerMatrix(y),w=Object.assign(l(y,b),h(y,b)),E={},G;["u","d"].forEach(I=>{G=I==="u"?b:Object.values(b).reverse(),["l","r"].forEach(R=>{R==="r"&&(G=G.map(A=>Object.values(A).reverse()));let k=(I==="u"?y.predecessors:y.successors).bind(y),S=f(y,G,w,k),T=p(y,G,S.root,S.align,R==="r");R==="r"&&(T=a.mapValues(T,A=>-A)),E[I+R]=T;});});let O=g(y,E);return m(E,O),v(E,y.graph().align)}function M(y,b,w){return (E,G,O)=>{let I=E.node(G),R=E.node(O),k=0,S;if(k+=I.width/2,Object.hasOwn(I,"labelpos"))switch(I.labelpos.toLowerCase()){case "l":S=-I.width/2;break;case "r":S=I.width/2;break}if(S&&(k+=w?S:-S),S=0,k+=(I.dummy?b:y)/2,k+=(R.dummy?b:y)/2,k+=R.width/2,Object.hasOwn(R,"labelpos"))switch(R.labelpos.toLowerCase()){case "l":S=R.width/2;break;case "r":S=-R.width/2;break}return S&&(k+=w?S:-S),S=0,k}}function L(y,b){return y.node(b).width}},{"../util":27,"@dagrejs/graphlib":29}],22:[function(t,o,i){let c=t("../util"),a=t("./bk").positionX;o.exports=l;function l(d){d=c.asNonCompoundGraph(d),h(d),Object.entries(a(d)).forEach(([u,s])=>d.node(u).x=s);}function h(d){let u=c.buildLayerMatrix(d),s=d.graph().ranksep,f=0;u.forEach(p=>{let x=p.reduce((g,m)=>{let v=d.node(m).height;return g>v?g:v},0);p.forEach(g=>d.node(g).y=f+x/2),f+=x+s;});}},{"../util":27,"./bk":21}],23:[function(t,o,i){var c=t("@dagrejs/graphlib").Graph,a=t("./util").slack;o.exports=l;function l(s){var f=new c({directed:false}),p=s.nodes()[0],x=s.nodeCount();f.setNode(p,{});for(var g,m;h(f,s)<x;)g=d(f,s),m=f.hasNode(g.v)?a(s,g):-a(s,g),u(f,s,m);return f}function h(s,f){function p(x){f.nodeEdges(x).forEach(g=>{var m=g.v,v=x===m?g.w:m;!s.hasNode(v)&&!a(f,g)&&(s.setNode(v,{}),s.setEdge(x,v,{}),p(v));});}return s.nodes().forEach(p),s.nodeCount()}function d(s,f){return f.edges().reduce((x,g)=>{let m=Number.POSITIVE_INFINITY;return s.hasNode(g.v)!==s.hasNode(g.w)&&(m=a(f,g)),m<x[0]?[m,g]:x},[Number.POSITIVE_INFINITY,null])[1]}function u(s,f,p){s.nodes().forEach(x=>f.node(x).rank+=p);}},{"./util":26,"@dagrejs/graphlib":29}],24:[function(t,o,i){var c=t("./util"),a=c.longestPath,l=t("./feasible-tree"),h=t("./network-simplex");o.exports=d;function d(p){var x=p.graph().ranker;if(x instanceof Function)return x(p);switch(p.graph().ranker){case "network-simplex":f(p);break;case "tight-tree":s(p);break;case "longest-path":u(p);break;case "none":break;default:f(p);}}var u=a;function s(p){a(p),l(p);}function f(p){h(p);}},{"./feasible-tree":23,"./network-simplex":25,"./util":26}],25:[function(t,o,i){var c=t("./feasible-tree"),a=t("./util").slack,l=t("./util").longestPath,h=t("@dagrejs/graphlib").alg.preorder,d=t("@dagrejs/graphlib").alg.postorder,u=t("../util").simplify;o.exports=s,s.initLowLimValues=g,s.initCutValues=f,s.calcCutValue=x,s.leaveEdge=v,s.enterEdge=$,s.exchangeEdges=M;function s(w){w=u(w),l(w);var E=c(w);g(E),f(E,w);for(var G,O;G=v(E);)O=$(E,w,G),M(E,w,G,O);}function f(w,E){var G=d(w,w.nodes());G=G.slice(0,G.length-1),G.forEach(O=>p(w,E,O));}function p(w,E,G){var O=w.node(G),I=O.parent;w.edge(G,I).cutvalue=x(w,E,G);}function x(w,E,G){var O=w.node(G),I=O.parent,R=true,k=E.edge(G,I),S=0;return k||(R=false,k=E.edge(I,G)),S=k.weight,E.nodeEdges(G).forEach(T=>{var A=T.v===G,C=A?T.w:T.v;if(C!==I){var W=A===R,U=E.edge(T).weight;if(S+=W?U:-U,y(w,G,C)){var P=w.edge(G,C).cutvalue;S+=W?-P:P;}}}),S}function g(w,E){arguments.length<2&&(E=w.nodes()[0]),m(w,{},1,E);}function m(w,E,G,O,I){var R=G,k=w.node(O);return E[O]=true,w.neighbors(O).forEach(S=>{Object.hasOwn(E,S)||(G=m(w,E,G,S,O));}),k.low=R,k.lim=G++,I?k.parent=I:delete k.parent,G}function v(w){return w.edges().find(E=>w.edge(E).cutvalue<0)}function $(w,E,G){var O=G.v,I=G.w;E.hasEdge(O,I)||(O=G.w,I=G.v);var R=w.node(O),k=w.node(I),S=R,T=false;R.lim>k.lim&&(S=k,T=true);var A=E.edges().filter(C=>T===b(w,w.node(C.v),S)&&T!==b(w,w.node(C.w),S));return A.reduce((C,W)=>a(E,W)<a(E,C)?W:C)}function M(w,E,G,O){var I=G.v,R=G.w;w.removeEdge(I,R),w.setEdge(O.v,O.w,{}),g(w),f(w,E),L(w,E);}function L(w,E){var G=w.nodes().find(I=>!E.node(I).parent),O=h(w,G);O=O.slice(1),O.forEach(I=>{var R=w.node(I).parent,k=E.edge(I,R),S=false;k||(k=E.edge(R,I),S=true),E.node(I).rank=E.node(R).rank+(S?k.minlen:-k.minlen);});}function y(w,E,G){return w.hasEdge(E,G)}function b(w,E,G){return G.low<=E.lim&&E.lim<=G.lim}},{"../util":27,"./feasible-tree":23,"./util":26,"@dagrejs/graphlib":29}],26:[function(t,o,i){let{applyWithChunking:c}=t("../util");o.exports={longestPath:a,slack:l};function a(h){var d={};function u(s){var f=h.node(s);if(Object.hasOwn(d,s))return f.rank;d[s]=true;let p=h.outEdges(s).map(g=>g==null?Number.POSITIVE_INFINITY:u(g.w)-h.edge(g).minlen);var x=c(Math.min,p);return x===Number.POSITIVE_INFINITY&&(x=0),f.rank=x}h.sources().forEach(u);}function l(h,d){return h.node(d.w).rank-h.node(d.v).rank-h.edge(d).minlen}},{"../util":27}],27:[function(t,o,i){let c=t("@dagrejs/graphlib").Graph;o.exports={addBorderNode:g,addDummyNode:a,applyWithChunking:$,asNonCompoundGraph:h,buildLayerMatrix:f,intersectRect:s,mapValues:I,maxRank:M,normalizeRanks:p,notime:b,partition:L,pick:O,predecessorWeights:u,range:G,removeEmptyRanks:x,simplify:l,successorWeights:d,time:y,uniqueId:E,zipObject:R};function a(k,S,T,A){for(var C=A;k.hasNode(C);)C=E(A);return T.dummy=S,k.setNode(C,T),C}function l(k){let S=new c().setGraph(k.graph());return k.nodes().forEach(T=>S.setNode(T,k.node(T))),k.edges().forEach(T=>{let A=S.edge(T.v,T.w)||{weight:0,minlen:1},C=k.edge(T);S.setEdge(T.v,T.w,{weight:A.weight+C.weight,minlen:Math.max(A.minlen,C.minlen)});}),S}function h(k){let S=new c({multigraph:k.isMultigraph()}).setGraph(k.graph());return k.nodes().forEach(T=>{k.children(T).length||S.setNode(T,k.node(T));}),k.edges().forEach(T=>{S.setEdge(T,k.edge(T));}),S}function d(k){let S=k.nodes().map(T=>{let A={};return k.outEdges(T).forEach(C=>{A[C.w]=(A[C.w]||0)+k.edge(C).weight;}),A});return R(k.nodes(),S)}function u(k){let S=k.nodes().map(T=>{let A={};return k.inEdges(T).forEach(C=>{A[C.v]=(A[C.v]||0)+k.edge(C).weight;}),A});return R(k.nodes(),S)}function s(k,S){let T=k.x,A=k.y,C=S.x-T,W=S.y-A,U=k.width/2,P=k.height/2;if(!C&&!W)throw new Error("Not possible to find intersection inside of the rectangle");let j,B;return Math.abs(W)*U>Math.abs(C)*P?(W<0&&(P=-P),j=P*C/W,B=P):(C<0&&(U=-U),j=U,B=U*W/C),{x:T+j,y:A+B}}function f(k){let S=G(M(k)+1).map(()=>[]);return k.nodes().forEach(T=>{let A=k.node(T),C=A.rank;C!==void 0&&(S[C][A.order]=T);}),S}function p(k){let S=k.nodes().map(A=>{let C=k.node(A).rank;return C===void 0?Number.MAX_VALUE:C}),T=$(Math.min,S);k.nodes().forEach(A=>{let C=k.node(A);Object.hasOwn(C,"rank")&&(C.rank-=T);});}function x(k){let S=k.nodes().map(U=>k.node(U).rank),T=$(Math.min,S),A=[];k.nodes().forEach(U=>{let P=k.node(U).rank-T;A[P]||(A[P]=[]),A[P].push(U);});let C=0,W=k.graph().nodeRankFactor;Array.from(A).forEach((U,P)=>{U===void 0&&P%W!==0?--C:U!==void 0&&C&&U.forEach(j=>k.node(j).rank+=C);});}function g(k,S,T,A){let C={width:0,height:0};return arguments.length>=4&&(C.rank=T,C.order=A),a(k,"border",C,S)}function m(k,S=v){let T=[];for(let A=0;A<k.length;A+=S){let C=k.slice(A,A+S);T.push(C);}return T}let v=65535;function $(k,S){if(S.length>v){let T=m(S);return k.apply(null,T.map(A=>k.apply(null,A)))}else return k.apply(null,S)}function M(k){let T=k.nodes().map(A=>{let C=k.node(A).rank;return C===void 0?Number.MIN_VALUE:C});return $(Math.max,T)}function L(k,S){let T={lhs:[],rhs:[]};return k.forEach(A=>{S(A)?T.lhs.push(A):T.rhs.push(A);}),T}function y(k,S){let T=Date.now();try{return S()}finally{console.log(k+" time: "+(Date.now()-T)+"ms");}}function b(k,S){return S()}let w=0;function E(k){var S=++w;return k+(""+S)}function G(k,S,T=1){S==null&&(S=k,k=0);let A=W=>W<S;T<0&&(A=W=>S<W);let C=[];for(let W=k;A(W);W+=T)C.push(W);return C}function O(k,S){let T={};for(let A of S)k[A]!==void 0&&(T[A]=k[A]);return T}function I(k,S){let T=S;return typeof S=="string"&&(T=A=>A[S]),Object.entries(k).reduce((A,[C,W])=>(A[C]=T(W,C),A),{})}function R(k,S){return k.reduce((T,A,C)=>(T[A]=S[C],T),{})}},{"@dagrejs/graphlib":29}],28:[function(t,o,i){o.exports="1.1.8";},{}],29:[function(t,o,i){var c=t("./lib");o.exports={Graph:c.Graph,json:t("./lib/json"),alg:t("./lib/alg"),version:c.version};},{"./lib":45,"./lib/alg":36,"./lib/json":46}],30:[function(t,o,i){o.exports=c;function c(a){var l={},h=[],d;function u(s){Object.hasOwn(l,s)||(l[s]=true,d.push(s),a.successors(s).forEach(u),a.predecessors(s).forEach(u));}return a.nodes().forEach(function(s){d=[],u(s),d.length&&h.push(d);}),h}},{}],31:[function(t,o,i){o.exports=c;function c(d,u,s){Array.isArray(u)||(u=[u]);var f=d.isDirected()?m=>d.successors(m):m=>d.neighbors(m),p=s==="post"?a:l,x=[],g={};return u.forEach(m=>{if(!d.hasNode(m))throw new Error("Graph does not have node: "+m);p(m,f,g,x);}),x}function a(d,u,s,f){for(var p=[[d,false]];p.length>0;){var x=p.pop();x[1]?f.push(x[0]):Object.hasOwn(s,x[0])||(s[x[0]]=true,p.push([x[0],true]),h(u(x[0]),g=>p.push([g,false])));}}function l(d,u,s,f){for(var p=[d];p.length>0;){var x=p.pop();Object.hasOwn(s,x)||(s[x]=true,f.push(x),h(u(x),g=>p.push(g)));}}function h(d,u){for(var s=d.length;s--;)u(d[s],s,d);return d}},{}],32:[function(t,o,i){var c=t("./dijkstra");o.exports=a;function a(l,h,d){return l.nodes().reduce(function(u,s){return u[s]=c(l,s,h,d),u},{})}},{"./dijkstra":33}],33:[function(t,o,i){var c=t("../data/priority-queue");o.exports=l;var a=()=>1;function l(d,u,s,f){return h(d,String(u),s||a,f||function(p){return d.outEdges(p)})}function h(d,u,s,f){var p={},x=new c,g,m,v=function($){var M=$.v!==g?$.v:$.w,L=p[M],y=s($),b=m.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+$+" Weight: "+y);b<L.distance&&(L.distance=b,L.predecessor=g,x.decrease(M,b));};for(d.nodes().forEach(function($){var M=$===u?0:Number.POSITIVE_INFINITY;p[$]={distance:M},x.add($,M);});x.size()>0&&(g=x.removeMin(),m=p[g],m.distance!==Number.POSITIVE_INFINITY);)f(g).forEach(v);return p}},{"../data/priority-queue":43}],34:[function(t,o,i){var c=t("./tarjan");o.exports=a;function a(l){return c(l).filter(function(h){return h.length>1||h.length===1&&l.hasEdge(h[0],h[0])})}},{"./tarjan":41}],35:[function(t,o,i){o.exports=a;var c=()=>1;function a(h,d,u){return l(h,d||c,u||function(s){return h.outEdges(s)})}function l(h,d,u){var s={},f=h.nodes();return f.forEach(function(p){s[p]={},s[p][p]={distance:0},f.forEach(function(x){p!==x&&(s[p][x]={distance:Number.POSITIVE_INFINITY});}),u(p).forEach(function(x){var g=x.v===p?x.w:x.v,m=d(x);s[p][g]={distance:m,predecessor:p};});}),f.forEach(function(p){var x=s[p];f.forEach(function(g){var m=s[g];f.forEach(function(v){var $=m[p],M=x[v],L=m[v],y=$.distance+M.distance;y<L.distance&&(L.distance=y,L.predecessor=M.predecessor);});});}),s}},{}],36:[function(t,o,i){o.exports={components:t("./components"),dijkstra:t("./dijkstra"),dijkstraAll:t("./dijkstra-all"),findCycles:t("./find-cycles"),floydWarshall:t("./floyd-warshall"),isAcyclic:t("./is-acyclic"),postorder:t("./postorder"),preorder:t("./preorder"),prim:t("./prim"),tarjan:t("./tarjan"),topsort:t("./topsort")};},{"./components":30,"./dijkstra":33,"./dijkstra-all":32,"./find-cycles":34,"./floyd-warshall":35,"./is-acyclic":37,"./postorder":38,"./preorder":39,"./prim":40,"./tarjan":41,"./topsort":42}],37:[function(t,o,i){var c=t("./topsort");o.exports=a;function a(l){try{c(l);}catch(h){if(h instanceof c.CycleException)return  false;throw h}return  true}},{"./topsort":42}],38:[function(t,o,i){var c=t("./dfs");o.exports=a;function a(l,h){return c(l,h,"post")}},{"./dfs":31}],39:[function(t,o,i){var c=t("./dfs");o.exports=a;function a(l,h){return c(l,h,"pre")}},{"./dfs":31}],40:[function(t,o,i){var c=t("../graph"),a=t("../data/priority-queue");o.exports=l;function l(h,d){var u=new c,s={},f=new a,p;function x(m){var v=m.v===p?m.w:m.v,$=f.priority(v);if($!==void 0){var M=d(m);M<$&&(s[v]=p,f.decrease(v,M));}}if(h.nodeCount()===0)return u;h.nodes().forEach(function(m){f.add(m,Number.POSITIVE_INFINITY),u.setNode(m);}),f.decrease(h.nodes()[0],0);for(var g=false;f.size()>0;){if(p=f.removeMin(),Object.hasOwn(s,p))u.setEdge(p,s[p]);else {if(g)throw new Error("Input graph is not connected: "+h);g=true;}h.nodeEdges(p).forEach(x);}return u}},{"../data/priority-queue":43,"../graph":44}],41:[function(t,o,i){o.exports=c;function c(a){var l=0,h=[],d={},u=[];function s(f){var p=d[f]={onStack:true,lowlink:l,index:l++};if(h.push(f),a.successors(f).forEach(function(m){Object.hasOwn(d,m)?d[m].onStack&&(p.lowlink=Math.min(p.lowlink,d[m].index)):(s(m),p.lowlink=Math.min(p.lowlink,d[m].lowlink));}),p.lowlink===p.index){var x=[],g;do g=h.pop(),d[g].onStack=false,x.push(g);while(f!==g);u.push(x);}}return a.nodes().forEach(function(f){Object.hasOwn(d,f)||s(f);}),u}},{}],42:[function(t,o,i){function c(l){var h={},d={},u=[];function s(f){if(Object.hasOwn(d,f))throw new a;Object.hasOwn(h,f)||(d[f]=true,h[f]=true,l.predecessors(f).forEach(s),delete d[f],u.push(f));}if(l.sinks().forEach(s),Object.keys(h).length!==l.nodeCount())throw new a;return u}class a extends Error{constructor(){super(...arguments);}}o.exports=c,c.CycleException=a;},{}],43:[function(t,o,i){class c{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(l){return l.key})}has(l){return Object.hasOwn(this._keyIndices,l)}priority(l){var h=this._keyIndices[l];if(h!==void 0)return this._arr[h].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(l,h){var d=this._keyIndices;if(l=String(l),!Object.hasOwn(d,l)){var u=this._arr,s=u.length;return d[l]=s,u.push({key:l,priority:h}),this._decrease(s),true}return  false}removeMin(){this._swap(0,this._arr.length-1);var l=this._arr.pop();return delete this._keyIndices[l.key],this._heapify(0),l.key}decrease(l,h){var d=this._keyIndices[l];if(h>this._arr[d].priority)throw new Error("New priority is greater than current priority. Key: "+l+" Old: "+this._arr[d].priority+" New: "+h);this._arr[d].priority=h,this._decrease(d);}_heapify(l){var h=this._arr,d=2*l,u=d+1,s=l;d<h.length&&(s=h[d].priority<h[s].priority?d:s,u<h.length&&(s=h[u].priority<h[s].priority?u:s),s!==l&&(this._swap(l,s),this._heapify(s)));}_decrease(l){for(var h=this._arr,d=h[l].priority,u;l!==0&&(u=l>>1,!(h[u].priority<d));)this._swap(l,u),l=u;}_swap(l,h){var d=this._arr,u=this._keyIndices,s=d[l],f=d[h];d[l]=f,d[h]=s,u[f.key]=l,u[s.key]=h;}}o.exports=c;},{}],44:[function(t,o,i){var c="\0",a="\0",l="";class h{_isDirected=true;_isMultigraph=false;_isCompound=false;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(g){g&&(this._isDirected=Object.hasOwn(g,"directed")?g.directed:true,this._isMultigraph=Object.hasOwn(g,"multigraph")?g.multigraph:false,this._isCompound=Object.hasOwn(g,"compound")?g.compound:false),this._isCompound&&(this._parent={},this._children={},this._children[a]={});}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(g){return this._label=g,this}graph(){return this._label}setDefaultNodeLabel(g){return this._defaultNodeLabelFn=g,typeof g!="function"&&(this._defaultNodeLabelFn=()=>g),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var g=this;return this.nodes().filter(m=>Object.keys(g._in[m]).length===0)}sinks(){var g=this;return this.nodes().filter(m=>Object.keys(g._out[m]).length===0)}setNodes(g,m){var v=arguments,$=this;return g.forEach(function(M){v.length>1?$.setNode(M,m):$.setNode(M);}),this}setNode(g,m){return Object.hasOwn(this._nodes,g)?(arguments.length>1&&(this._nodes[g]=m),this):(this._nodes[g]=arguments.length>1?m:this._defaultNodeLabelFn(g),this._isCompound&&(this._parent[g]=a,this._children[g]={},this._children[a][g]=true),this._in[g]={},this._preds[g]={},this._out[g]={},this._sucs[g]={},++this._nodeCount,this)}node(g){return this._nodes[g]}hasNode(g){return Object.hasOwn(this._nodes,g)}removeNode(g){var m=this;if(Object.hasOwn(this._nodes,g)){var v=$=>m.removeEdge(m._edgeObjs[$]);delete this._nodes[g],this._isCompound&&(this._removeFromParentsChildList(g),delete this._parent[g],this.children(g).forEach(function($){m.setParent($);}),delete this._children[g]),Object.keys(this._in[g]).forEach(v),delete this._in[g],delete this._preds[g],Object.keys(this._out[g]).forEach(v),delete this._out[g],delete this._sucs[g],--this._nodeCount;}return this}setParent(g,m){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(m===void 0)m=a;else {m+="";for(var v=m;v!==void 0;v=this.parent(v))if(v===g)throw new Error("Setting "+m+" as parent of "+g+" would create a cycle");this.setNode(m);}return this.setNode(g),this._removeFromParentsChildList(g),this._parent[g]=m,this._children[m][g]=true,this}_removeFromParentsChildList(g){delete this._children[this._parent[g]][g];}parent(g){if(this._isCompound){var m=this._parent[g];if(m!==a)return m}}children(g=a){if(this._isCompound){var m=this._children[g];if(m)return Object.keys(m)}else {if(g===a)return this.nodes();if(this.hasNode(g))return []}}predecessors(g){var m=this._preds[g];if(m)return Object.keys(m)}successors(g){var m=this._sucs[g];if(m)return Object.keys(m)}neighbors(g){var m=this.predecessors(g);if(m){let $=new Set(m);for(var v of this.successors(g))$.add(v);return Array.from($.values())}}isLeaf(g){var m;return this.isDirected()?m=this.successors(g):m=this.neighbors(g),m.length===0}filterNodes(g){var m=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});m.setGraph(this.graph());var v=this;Object.entries(this._nodes).forEach(function([L,y]){g(L)&&m.setNode(L,y);}),Object.values(this._edgeObjs).forEach(function(L){m.hasNode(L.v)&&m.hasNode(L.w)&&m.setEdge(L,v.edge(L));});var $={};function M(L){var y=v.parent(L);return y===void 0||m.hasNode(y)?($[L]=y,y):y in $?$[y]:M(y)}return this._isCompound&&m.nodes().forEach(L=>m.setParent(L,M(L))),m}setDefaultEdgeLabel(g){return this._defaultEdgeLabelFn=g,typeof g!="function"&&(this._defaultEdgeLabelFn=()=>g),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(g,m){var v=this,$=arguments;return g.reduce(function(M,L){return $.length>1?v.setEdge(M,L,m):v.setEdge(M,L),L}),this}setEdge(){var g,m,v,$,M=false,L=arguments[0];typeof L=="object"&&L!==null&&"v"in L?(g=L.v,m=L.w,v=L.name,arguments.length===2&&($=arguments[1],M=true)):(g=L,m=arguments[1],v=arguments[3],arguments.length>2&&($=arguments[2],M=true)),g=""+g,m=""+m,v!==void 0&&(v=""+v);var y=s(this._isDirected,g,m,v);if(Object.hasOwn(this._edgeLabels,y))return M&&(this._edgeLabels[y]=$),this;if(v!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(g),this.setNode(m),this._edgeLabels[y]=M?$:this._defaultEdgeLabelFn(g,m,v);var b=f(this._isDirected,g,m,v);return g=b.v,m=b.w,Object.freeze(b),this._edgeObjs[y]=b,d(this._preds[m],g),d(this._sucs[g],m),this._in[m][y]=b,this._out[g][y]=b,this._edgeCount++,this}edge(g,m,v){var $=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,g,m,v);return this._edgeLabels[$]}edgeAsObj(){let g=this.edge(...arguments);return typeof g!="object"?{label:g}:g}hasEdge(g,m,v){var $=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,g,m,v);return Object.hasOwn(this._edgeLabels,$)}removeEdge(g,m,v){var $=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,g,m,v),M=this._edgeObjs[$];return M&&(g=M.v,m=M.w,delete this._edgeLabels[$],delete this._edgeObjs[$],u(this._preds[m],g),u(this._sucs[g],m),delete this._in[m][$],delete this._out[g][$],this._edgeCount--),this}inEdges(g,m){var v=this._in[g];if(v){var $=Object.values(v);return m?$.filter(M=>M.v===m):$}}outEdges(g,m){var v=this._out[g];if(v){var $=Object.values(v);return m?$.filter(M=>M.w===m):$}}nodeEdges(g,m){var v=this.inEdges(g,m);if(v)return v.concat(this.outEdges(g,m))}}function d(x,g){x[g]?x[g]++:x[g]=1;}function u(x,g){--x[g]||delete x[g];}function s(x,g,m,v){var $=""+g,M=""+m;if(!x&&$>M){var L=$;$=M,M=L;}return $+l+M+l+(v===void 0?c:v)}function f(x,g,m,v){var $=""+g,M=""+m;if(!x&&$>M){var L=$;$=M,M=L;}var y={v:$,w:M};return v&&(y.name=v),y}function p(x,g){return s(x,g.v,g.w,g.name)}o.exports=h;},{}],45:[function(t,o,i){o.exports={Graph:t("./graph"),version:t("./version")};},{"./graph":44,"./version":47}],46:[function(t,o,i){var c=t("./graph");o.exports={write:a,read:d};function a(u){var s={options:{directed:u.isDirected(),multigraph:u.isMultigraph(),compound:u.isCompound()},nodes:l(u),edges:h(u)};return u.graph()!==void 0&&(s.value=structuredClone(u.graph())),s}function l(u){return u.nodes().map(function(s){var f=u.node(s),p=u.parent(s),x={v:s};return f!==void 0&&(x.value=f),p!==void 0&&(x.parent=p),x})}function h(u){return u.edges().map(function(s){var f=u.edge(s),p={v:s.v,w:s.w};return s.name!==void 0&&(p.name=s.name),f!==void 0&&(p.value=f),p})}function d(u){var s=new c(u.options).setGraph(u.value);return u.nodes.forEach(function(f){s.setNode(f.v,f.value),f.parent&&s.setParent(f.v,f.parent);}),u.edges.forEach(function(f){s.setEdge({v:f.v,w:f.w,name:f.name},f.value);}),s}},{"./graph":44}],47:[function(t,o,i){o.exports="2.2.4";},{}]},{},[1])(1)});});var Oe={bg:"#0A0A0A",fg:"#EDEDED"},ye={textSec:60,textMuted:40,textFaint:25,line:30,arrow:50,nodeFill:3,nodeStroke:20,groupHeader:5,innerStroke:12,keyBadge:10},pt={"zinc-dark":{bg:"#18181B",fg:"#FAFAFA"},"tokyo-night":{bg:"#1a1b26",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-storm":{bg:"#24283b",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-light":{bg:"#d5d6db",fg:"#343b58",line:"#34548a",accent:"#34548a",muted:"#9699a3"},"catppuccin-mocha":{bg:"#1e1e2e",fg:"#cdd6f4",line:"#585b70",accent:"#cba6f7",muted:"#6c7086"},"catppuccin-latte":{bg:"#eff1f5",fg:"#4c4f69",line:"#9ca0b0",accent:"#8839ef",muted:"#9ca0b0"},nord:{bg:"#2e3440",fg:"#d8dee9",line:"#4c566a",accent:"#88c0d0",muted:"#616e88"},"nord-light":{bg:"#eceff4",fg:"#2e3440",line:"#aab1c0",accent:"#5e81ac",muted:"#7b88a1"},dracula:{bg:"#282a36",fg:"#f8f8f2",line:"#6272a4",accent:"#bd93f9",muted:"#6272a4"},"github-light":{bg:"#ffffff",fg:"#1f2328",line:"#d1d9e0",accent:"#0969da",muted:"#59636e"},"github-dark":{bg:"#0d1117",fg:"#e6edf3",line:"#3d444d",accent:"#4493f8",muted:"#9198a1"},"solarized-light":{bg:"#fdf6e3",fg:"#657b83",line:"#93a1a1",accent:"#268bd2",muted:"#93a1a1"},"solarized-dark":{bg:"#002b36",fg:"#839496",line:"#586e75",accent:"#268bd2",muted:"#586e75"},"one-dark":{bg:"#282c34",fg:"#abb2bf",line:"#4b5263",accent:"#c678dd",muted:"#5c6370"},"vercel-dark":{bg:"#0A0A0A",fg:"#EDEDED",line:"#EDEDED",accent:"#EDEDED",muted:"#888888",surface:"#0A0A0A",border:"#454545"},"vercel-light":{bg:"#FFFFFF",fg:"#171717",line:"#EAEAEA",accent:"#000000",muted:"#888888",surface:"#FAFAFA",border:"#EAEAEA"}};function gt(e){let n=e.colors??{},r=e.type==="dark",t=o=>e.tokenColors?.find(i=>Array.isArray(i.scope)?i.scope.includes(o):i.scope===o)?.settings?.foreground;return {bg:n["editor.background"]??(r?"#1e1e1e":"#ffffff"),fg:n["editor.foreground"]??(r?"#d4d4d4":"#333333"),line:n["editorLineNumber.foreground"]??void 0,accent:n.focusBorder??t("keyword")??void 0,muted:t("comment")??n["editorLineNumber.foreground"]??void 0,surface:n["editor.selectionBackground"]??void 0,border:n["editorWidget.border"]??void 0}}function Ce(e,n){let r=[`@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(e)}:wght@400;500;600;700&amp;display=swap');`,...n?["@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');"]:[]],t=`
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${ye.textSec}%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${ye.textMuted}%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) ${ye.textFaint}%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) ${ye.line}%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${ye.arrow}%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${ye.nodeFill}%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${ye.nodeStroke}%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) ${ye.groupHeader}%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) ${ye.innerStroke}%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) ${ye.keyBadge}%, var(--bg));`;return ["<style>",`  ${r.join(`
  `)}`,`  text { font-family: '${e}', system-ui, sans-serif; }`,...n?["  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }"]:[],`  svg {${t}`,"  }","</style>"].join(`
`)}function Se(e,n,r,t){let o=[`--bg:${r.bg}`,`--fg:${r.fg}`,r.line?`--line:${r.line}`:"",r.accent?`--accent:${r.accent}`:"",r.muted?`--muted:${r.muted}`:"",r.surface?`--surface:${r.surface}`:"",r.border?`--border:${r.border}`:""].filter(Boolean).join(";");return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${n}" width="${e}" height="${n}" style="${o}${t?"":";background:var(--bg)"}">`}function Fe(e){let n=e.split(/[\n;]/).map(t=>t.trim()).filter(t=>t.length>0&&!t.startsWith("%%"));if(n.length===0)throw new Error("Empty mermaid diagram");let r=n[0];return /^stateDiagram(-v2)?\s*$/i.test(r)?rr(n):nr(n)}function nr(e){let n=e[0].match(/^(?:graph|flowchart)\s+(TD|TB|LR|BT|RL)\s*$/i);if(!n)throw new Error(`Invalid mermaid header: "${e[0]}". Expected "graph TD", "flowchart LR", "stateDiagram-v2", etc.`);let t={direction:n[1].toUpperCase(),nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},o=[];for(let i=1;i<e.length;i++){let c=e[i],a=c.match(/^classDef\s+(\w+)\s+(.+)$/);if(a){let s=a[1],f=a[2],p=Wt(f);t.classDefs.set(s,p);continue}let l=c.match(/^class\s+([\w,-]+)\s+(\w+)$/);if(l){let s=l[1].split(",").map(p=>p.trim()),f=l[2];for(let p of s)t.classAssignments.set(p,f);continue}let h=c.match(/^style\s+([\w,-]+)\s+(.+)$/);if(h){let s=h[1].split(",").map(p=>p.trim()),f=Wt(h[2]);for(let p of s)t.nodeStyles.set(p,{...t.nodeStyles.get(p),...f});continue}let d=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(d&&o.length>0){o[o.length-1].direction=d[1].toUpperCase();continue}let u=c.match(/^subgraph\s+(.+)$/);if(u){let s=u[1].trim(),f=s.match(/^([\w-]+)\s*\[(.+)\]$/),p,x;f?(p=f[1],x=f[2]):(x=s,p=s.replace(/\s+/g,"_").replace(/[^\w]/g,""));let g={id:p,label:x,nodeIds:[],children:[]};o.push(g);continue}if(c==="end"){let s=o.pop();s&&(o.length>0?o[o.length-1].children.push(s):t.subgraphs.push(s));continue}cr(c,t,o);}return t}function rr(e){let n={direction:"TD",nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},r=[],t=0,o=0;for(let i=1;i<e.length;i++){let c=e[i],a=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(a){r.length>0?r[r.length-1].direction=a[1].toUpperCase():n.direction=a[1].toUpperCase();continue}let l=c.match(/^state\s+(?:"([^"]+)"\s+as\s+)?(\w+)\s*\{$/);if(l){let s=l[1]??l[2],p={id:l[2],label:s,nodeIds:[],children:[]};r.push(p);continue}if(c==="}"){let s=r.pop();s&&(r.length>0?r[r.length-1].children.push(s):n.subgraphs.push(s));continue}let h=c.match(/^state\s+"([^"]+)"\s+as\s+(\w+)\s*$/);if(h){let s=h[1],f=h[2];je(n,r,{id:f,label:s,shape:"rounded"});continue}let d=c.match(/^(\[\*\]|[\w-]+)\s*(-->)\s*(\[\*\]|[\w-]+)(?:\s*:\s*(.+))?$/);if(d){let s=d[1],f=d[3],p=d[4]?.trim()||void 0;s==="[*]"?(t++,s=`_start${t>1?t:""}`,je(n,r,{id:s,label:"",shape:"state-start"})):Ot(n,r,s),f==="[*]"?(o++,f=`_end${o>1?o:""}`,je(n,r,{id:f,label:"",shape:"state-end"})):Ot(n,r,f),n.edges.push({source:s,target:f,label:p,style:"solid",hasArrowStart:false,hasArrowEnd:true});continue}let u=c.match(/^([\w-]+)\s*:\s*(.+)$/);if(u){let s=u[1],f=u[2].trim();je(n,r,{id:s,label:f,shape:"rounded"});continue}}return n}function je(e,n,r){if(!e.nodes.has(r.id)&&e.nodes.set(r.id,r),n.length>0){let o=n[n.length-1];o.nodeIds.includes(r.id)||o.nodeIds.push(r.id);}}function Ot(e,n,r){if(!e.nodes.has(r))je(e,n,{id:r,label:r,shape:"rounded"});else if(n.length>0){let t=n[n.length-1];t.nodeIds.includes(r)||t.nodeIds.push(r);}}function Wt(e){let n={};for(let r of e.split(",")){let t=r.indexOf(":");if(t>0){let o=r.slice(0,t).trim(),i=r.slice(t+1).trim();o&&i&&(n[o]=i);}}return n}var or=/^(<)?(-->|-.->|==>|---|-\.-|===)(?:\|([^|]*)\|)?/,ir=[{regex:/^([\w-]+)\(\(\((.+?)\)\)\)/,shape:"doublecircle"},{regex:/^([\w-]+)\(\[(.+?)\]\)/,shape:"stadium"},{regex:/^([\w-]+)\(\((.+?)\)\)/,shape:"circle"},{regex:/^([\w-]+)\[\[(.+?)\]\]/,shape:"subroutine"},{regex:/^([\w-]+)\[\((.+?)\)\]/,shape:"cylinder"},{regex:/^([\w-]+)\[\/(.+?)\\\]/,shape:"trapezoid"},{regex:/^([\w-]+)\[\\(.+?)\/\]/,shape:"trapezoid-alt"},{regex:/^([\w-]+)>(.+?)\]/,shape:"asymmetric"},{regex:/^([\w-]+)\{\{(.+?)\}\}/,shape:"hexagon"},{regex:/^([\w-]+)\[(.+?)\]/,shape:"rectangle"},{regex:/^([\w-]+)\((.+?)\)/,shape:"rounded"},{regex:/^([\w-]+)\{(.+?)\}/,shape:"diamond"}],sr=/^([\w-]+)/,ar=/^:::([\w][\w-]*)/;function cr(e,n,r){let t=e.trim(),o=Ht(t,n,r);if(!o||o.ids.length===0)return;t=o.remaining.trim();let i=o.ids;for(;t.length>0;){let c=t.match(or);if(!c)break;let a=!!c[1],l=c[2],h=c[3]?.trim()||void 0;t=t.slice(c[0].length).trim();let d=lr(l),u=l.endsWith(">"),s=Ht(t,n,r);if(!s||s.ids.length===0)break;t=s.remaining.trim();for(let f of i)for(let p of s.ids)n.edges.push({source:f,target:p,label:h,style:d,hasArrowStart:a,hasArrowEnd:u});i=s.ids;}}function Ht(e,n,r){let t=Yt(e,n,r);if(!t)return null;let o=[t.id],i=t.remaining.trim();for(;i.startsWith("&");){i=i.slice(1).trim();let c=Yt(i,n,r);if(!c)break;o.push(c.id),i=c.remaining.trim();}return {ids:o,remaining:i}}function Yt(e,n,r){let t=null,o=e;for(let{regex:c,shape:a}of ir){let l=e.match(c);if(l){t=l[1];let h=l[2];Xt(n,r,{id:t,label:h,shape:a}),o=e.slice(l[0].length);break}}if(t===null){let c=e.match(sr);c&&(t=c[1],n.nodes.has(t)?Bt(r,t):Xt(n,r,{id:t,label:t,shape:"rectangle"}),o=e.slice(c[0].length));}if(t===null)return null;let i=o.match(ar);return i&&(n.classAssignments.set(t,i[1]),o=o.slice(i[0].length)),{id:t,remaining:o}}function Xt(e,n,r){!e.nodes.has(r.id)&&e.nodes.set(r.id,r),Bt(n,r.id);}function Bt(e,n){if(e.length>0){let r=e[e.length-1];r.nodeIds.includes(n)||r.nodeIds.push(n);}}function lr(e){return e==="-.->"||e==="-.-"?"dotted":e==="==>"||e==="==="?"thick":"solid"}var ie={x:1,y:0},ne={x:1,y:2},se={x:0,y:1},re={x:2,y:1},be={x:2,y:0},xe={x:0,y:0},$e={x:2,y:2},we={x:0,y:2},Qe={x:1,y:1};function mt(e,n){return e.x===n.x&&e.y===n.y}function jt(e,n){return e.x===n.x&&e.y===n.y}function ze(e,n){return {x:e.x+n.x,y:e.y+n.y}}function ve(e){return `${e.x},${e.y}`}var Ft={name:"",styles:{}};function he(e,n){let r=[];for(let t=0;t<=e;t++){let o=[];for(let i=0;i<=n;i++)o.push(" ");r.push(o);}return r}function Re(e){let[n,r]=Ve(e);return he(n,r)}function Ve(e){return [e.length-1,(e[0]?.length??1)-1]}function _e(e,n,r){let[t,o]=Ve(e),i=Math.max(n,t),c=Math.max(r,o),a=he(i,c);for(let l=0;l<a.length;l++)for(let h=0;h<a[0].length;h++)l<e.length&&h<e[0].length&&(a[l][h]=e[l][h]);return e.length=0,e.push(...a),e}var dr=new Set(["\u2500","\u2502","\u250C","\u2510","\u2514","\u2518","\u251C","\u2524","\u252C","\u2534","\u253C","\u2574","\u2575","\u2576","\u2577"]);function zt(e){return dr.has(e)}var hr={"\u2500":{"\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u2534"},"\u2502":{"\u2500":"\u253C","\u250C":"\u251C","\u2510":"\u2524","\u2514":"\u251C","\u2518":"\u2524","\u251C":"\u251C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u253C"},"\u250C":{"\u2500":"\u252C","\u2502":"\u251C","\u2510":"\u252C","\u2514":"\u251C","\u2518":"\u253C","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u253C"},"\u2510":{"\u2500":"\u252C","\u2502":"\u2524","\u250C":"\u252C","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u252C","\u2534":"\u253C"},"\u2514":{"\u2500":"\u2534","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2518":"\u2534","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u2534"},"\u2518":{"\u2500":"\u2534","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u2534","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u2534"},"\u251C":{"\u2500":"\u253C","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2514":"\u251C","\u2518":"\u253C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u2524":{"\u2500":"\u253C","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u252C":{"\u2500":"\u252C","\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u253C","\u2518":"\u253C","\u251C":"\u253C","\u2524":"\u253C","\u2534":"\u253C"},"\u2534":{"\u2500":"\u2534","\u2502":"\u253C","\u250C":"\u253C","\u2510":"\u253C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u253C"}};function fr(e,n){return hr[e]?.[n]??e}function ke(e,n,r,...t){let[o,i]=Ve(e);for(let a of t){let[l,h]=Ve(a);o=Math.max(o,l+n.x),i=Math.max(i,h+n.y);}let c=he(o,i);for(let a=0;a<=o;a++)for(let l=0;l<=i;l++)a<e.length&&l<e[0].length&&(c[a][l]=e[a][l]);for(let a of t)for(let l=0;l<a.length;l++)for(let h=0;h<a[0].length;h++){let d=a[l][h];if(d!==" "){let u=l+n.x,s=h+n.y,f=c[u][s];!r&&zt(d)&&zt(f)?c[u][s]=fr(f,d):c[u][s]=d;}}return c}function Ae(e){let[n,r]=Ve(e),t=[];for(let o=0;o<=r;o++){let i="";for(let c=0;c<=n;c++)i+=e[c][o];t.push(i);}return t.join(`
`)}var ur={"\u25B2":"\u25BC","\u25BC":"\u25B2","\u25E4":"\u25E3","\u25E3":"\u25E4","\u25E5":"\u25E2","\u25E2":"\u25E5","^":"v",v:"^","\u250C":"\u2514","\u2514":"\u250C","\u2510":"\u2518","\u2518":"\u2510","\u252C":"\u2534","\u2534":"\u252C","\u2575":"\u2577","\u2577":"\u2575"};function Vt(e){for(let n of e)n.reverse();for(let n of e)for(let r=0;r<n.length;r++){let t=ur[n[r]];t&&(n[r]=t);}return e}function Ut(e,n,r){_e(e,n.x+r.length,n.y);for(let t=0;t<r.length;t++)e[n.x+t][n.y]=r[t];}function qt(e,n,r){let t=0,o=0;for(let i of n.values())t+=i;for(let i of r.values())o+=i;_e(e,t-1,o-1);}function Kt(e,n){let r=new Map,t=0;for(let[a,l]of e.nodes){let h={name:a,displayLabel:l.label,index:t,gridCoord:null,drawingCoord:null,drawing:null,drawn:false,styleClassName:"",styleClass:Ft};r.set(a,h),t++;}let o=[...r.values()],i=[];for(let a of e.edges){let l=r.get(a.source),h=r.get(a.target);!l||!h||i.push({from:l,to:h,text:a.label??"",path:[],labelLine:[],startDir:{x:0,y:0},endDir:{x:0,y:0}});}let c=[];for(let a of e.subgraphs)Jt(a,null,r,c);pr(e.subgraphs,c,r);for(let[a,l]of e.classAssignments){let h=r.get(a),d=e.classDefs.get(l);h&&d&&(h.styleClassName=l,h.styleClass={name:l,styles:d});}return {nodes:o,edges:i,canvas:he(0,0),grid:new Map,columnWidth:new Map,rowHeight:new Map,subgraphs:c,config:n,offsetX:0,offsetY:0}}function Jt(e,n,r,t){let o={name:e.label,nodes:[],parent:n,children:[],minX:0,minY:0,maxX:0,maxY:0};for(let i of e.nodeIds){let c=r.get(i);c&&o.nodes.push(c);}t.push(o);for(let i of e.children){let c=Jt(i,o,r,t);o.children.push(c);for(let a of c.nodes)o.nodes.includes(a)||o.nodes.push(a);}return o}function pr(e,n,r,t){let o=new Map;mr(e,n,o);let i=new Map;function c(a){let l=o.get(a);if(l){for(let h of a.children)c(h);for(let h of a.nodeIds)i.has(h)||i.set(h,l);}}for(let a of e)c(a);for(let a of n)a.nodes=a.nodes.filter(l=>{let h;for(let[u,s]of r)if(s===l){h=u;break}if(!h)return  false;let d=i.get(h);return d?gr(a,d):true});}function gr(e,n){let r=n;for(;r!==null;){if(r===e)return  true;r=r.parent;}return  false}function mr(e,n,r){let t=[];function o(i){for(let c of i)t.push(c),o(c.children);}o(e);for(let i=0;i<t.length&&i<n.length;i++)r.set(t[i],n[i]);}var xt=class{items=[];get length(){return this.items.length}push(n){this.items.push(n),this.bubbleUp(this.items.length-1);}pop(){if(this.items.length===0)return;let n=this.items[0],r=this.items.pop();return this.items.length>0&&(this.items[0]=r,this.sinkDown(0)),n}bubbleUp(n){for(;n>0;){let r=n-1>>1;if(this.items[n].priority<this.items[r].priority)[this.items[n],this.items[r]]=[this.items[r],this.items[n]],n=r;else break}}sinkDown(n){let r=this.items.length;for(;;){let t=n,o=2*n+1,i=2*n+2;if(o<r&&this.items[o].priority<this.items[t].priority&&(t=o),i<r&&this.items[i].priority<this.items[t].priority&&(t=i),t!==n)[this.items[n],this.items[t]]=[this.items[t],this.items[n]],n=t;else break}}};function xr(e,n){let r=Math.abs(e.x-n.x),t=Math.abs(e.y-n.y);return r===0||t===0?r+t:r+t+1}var yr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];function br(e,n){return n.x<0||n.y<0?false:!e.has(ve(n))}function yt(e,n,r){let t=new xt;t.push({coord:n,priority:0});let o=new Map;o.set(ve(n),0);let i=new Map;for(i.set(ve(n),null);t.length>0;){let c=t.pop().coord;if(mt(c,r)){let l=[],h=c;for(;h!==null;)l.unshift(h),h=i.get(ve(h))??null;return l}let a=o.get(ve(c));for(let l of yr){let h={x:c.x+l.x,y:c.y+l.y};if(!br(e,h)&&!mt(h,r))continue;let d=a+1,u=ve(h),s=o.get(u);if(s===void 0||d<s){o.set(u,d);let f=d+xr(h,r);t.push({coord:h,priority:f}),i.set(u,c);}}}return null}function bt(e){if(e.length<=2)return e;let n=new Set,r=e[0],t=e[1];for(let o=2;o<e.length;o++){let i=e[o],c=t.x-r.x,a=t.y-r.y,l=i.x-t.x,h=i.y-t.y;c===l&&a===h&&n.add(o-1),r=t,t=i;}return e.filter((o,i)=>!n.has(i))}function et(e){return e===ie?ne:e===ne?ie:e===se?re:e===re?se:e===be?we:e===xe?$e:e===$e?xe:e===we?be:Qe}function q(e,n){return e.x===n.x&&e.y===n.y}function Le(e,n){return e.x===n.x?e.y<n.y?ne:ie:e.y===n.y?e.x<n.x?re:se:e.x<n.x?e.y<n.y?$e:be:e.y<n.y?we:xe}function wr(e){return e==="LR"?[re,ne,ne,re]:[ne,re,re,ne]}function vr(e,n){if(e.from===e.to)return wr(n);let r=Le(e.from.gridCoord,e.to.gridCoord),t,o,i,c,a=n==="LR"?q(r,se)||q(r,xe)||q(r,we):q(r,ie)||q(r,xe)||q(r,be);return q(r,$e)?n==="LR"?(t=ne,o=se,i=re,c=ie):(t=re,o=ie,i=ne,c=se):q(r,be)?n==="LR"?(t=ie,o=se,i=re,c=ne):(t=re,o=ne,i=ie,c=se):q(r,we)?n==="LR"?(t=ne,o=ne,i=se,c=ie):(t=se,o=ie,i=ne,c=re):q(r,xe)?n==="LR"?(t=ne,o=ne,i=se,c=ne):(t=re,o=re,i=ie,c=re):a?n==="LR"&&q(r,se)?(t=ne,o=ne,i=se,c=re):n==="TD"&&q(r,ie)?(t=re,o=re,i=ie,c=ne):(t=r,o=et(r),i=r,c=et(r)):(t=r,o=et(r),i=r,c=et(r)),[t,o,i,c]}function Zt(e,n){let[r,t,o,i]=vr(n,e.config.graphDirection),c=ze(n.from.gridCoord,r),a=ze(n.to.gridCoord,t),l=yt(e.grid,c,a);if(l===null){n.startDir=o,n.endDir=i,n.path=[];return}l=bt(l);let h=ze(n.from.gridCoord,o),d=ze(n.to.gridCoord,i),u=yt(e.grid,h,d);if(u===null){n.startDir=r,n.endDir=t,n.path=l;return}u=bt(u),l.length<=u.length?(n.startDir=r,n.endDir=t,n.path=l):(n.startDir=o,n.endDir=i,n.path=u);}function Qt(e,n){if(n.text.length===0)return;let r=n.text.length,t=n.path[0],o=[t,n.path[1]],i=0;for(let d=1;d<n.path.length;d++){let u=n.path[d],s=[t,u],f=$r(e,s);if(f>=r){o=s;break}else f>i&&(i=f,o=s);t=u;}let c=Math.min(o[0].x,o[1].x),a=Math.max(o[0].x,o[1].x),l=c+Math.floor((a-c)/2),h=e.columnWidth.get(l)??0;e.columnWidth.set(l,Math.max(h,r+2)),n.labelLine=[o[0],o[1]];}function $r(e,n){let r=0,t=Math.min(n[0].x,n[1].x),o=Math.max(n[0].x,n[1].x);for(let i=t;i<=o;i++)r+=e.columnWidth.get(i)??0;return r}function en(e,n){let r=e.gridCoord,t=n.config.useAscii,o=0;for(let s=0;s<2;s++)o+=n.columnWidth.get(r.x+s)??0;let i=0;for(let s=0;s<2;s++)i+=n.rowHeight.get(r.y+s)??0;let c={x:0,y:0},a={x:o,y:i},l=he(Math.max(c.x,a.x),Math.max(c.y,a.y));if(t){for(let s=c.x+1;s<a.x;s++)l[s][c.y]="-";for(let s=c.x+1;s<a.x;s++)l[s][a.y]="-";for(let s=c.y+1;s<a.y;s++)l[c.x][s]="|";for(let s=c.y+1;s<a.y;s++)l[a.x][s]="|";l[c.x][c.y]="+",l[a.x][c.y]="+",l[c.x][a.y]="+",l[a.x][a.y]="+";}else {for(let s=c.x+1;s<a.x;s++)l[s][c.y]="\u2500";for(let s=c.x+1;s<a.x;s++)l[s][a.y]="\u2500";for(let s=c.y+1;s<a.y;s++)l[c.x][s]="\u2502";for(let s=c.y+1;s<a.y;s++)l[a.x][s]="\u2502";l[c.x][c.y]="\u250C",l[a.x][c.y]="\u2510",l[c.x][a.y]="\u2514",l[a.x][a.y]="\u2518";}let h=e.displayLabel,d=c.y+Math.floor(i/2),u=c.x+Math.floor(o/2)-Math.ceil(h.length/2)+1;for(let s=0;s<h.length;s++)l[u+s][d]=h[s];return l}function tt(e,n,r=1){let t=0;for(let $ of e)for(let M of $)t=Math.max(t,M.length);let i=t+2*r+2,c=0;for(let $ of e)c+=Math.max($.length,1);let a=e.length-1,l=c+a+2,h=n?"-":"\u2500",d=n?"|":"\u2502",u=n?"+":"\u250C",s=n?"+":"\u2510",f=n?"+":"\u2514",p=n?"+":"\u2518",x=n?"+":"\u251C",g=n?"+":"\u2524",m=he(i-1,l-1);m[0][0]=u;for(let $=1;$<i-1;$++)m[$][0]=h;m[i-1][0]=s,m[0][l-1]=f;for(let $=1;$<i-1;$++)m[$][l-1]=h;m[i-1][l-1]=p;for(let $=1;$<l-1;$++)m[0][$]=d,m[i-1][$]=d;let v=1;for(let $=0;$<e.length;$++){let M=e[$],L=M.length>0?M:[""];for(let y of L){let b=1+r;for(let w=0;w<y.length;w++)m[b+w][v]=y[w];v++;}if($<e.length-1){m[0][v]=x;for(let y=1;y<i-1;y++)m[y][v]=h;m[i-1][v]=g,v++;}}return m}function kr(e,n,r,t,o,i){let c=Le(n,r),a=[],l=i?"-":"\u2500",h=i?"|":"\u2502",d=i?"\\":"\u2572",u=i?"/":"\u2571";if(q(c,ie))for(let s=n.y-t;s>=r.y-o;s--)a.push({x:n.x,y:s}),e[n.x][s]=h;else if(q(c,ne))for(let s=n.y+t;s<=r.y+o;s++)a.push({x:n.x,y:s}),e[n.x][s]=h;else if(q(c,se))for(let s=n.x-t;s>=r.x-o;s--)a.push({x:s,y:n.y}),e[s][n.y]=l;else if(q(c,re))for(let s=n.x+t;s<=r.x+o;s++)a.push({x:s,y:n.y}),e[s][n.y]=l;else if(q(c,xe))for(let s=n.x,f=n.y-t;s>=r.x-o&&f>=r.y-o;s--,f--)a.push({x:s,y:f}),e[s][f]=d;else if(q(c,be))for(let s=n.x,f=n.y-t;s<=r.x+o&&f>=r.y-o;s++,f--)a.push({x:s,y:f}),e[s][f]=u;else if(q(c,we))for(let s=n.x,f=n.y+t;s>=r.x-o&&f<=r.y+o;s--,f++)a.push({x:s,y:f}),e[s][f]=u;else if(q(c,$e))for(let s=n.x,f=n.y+t;s<=r.x+o&&f<=r.y+o;s++,f++)a.push({x:s,y:f}),e[s][f]=d;return a}function Er(e,n){if(n.path.length===0){let h=Re(e.canvas);return [h,h,h,h,h]}let r=Ar(e,n),[t,o,i]=Mr(e,n.path),c=Cr(e,n.path,o[0]),a=Sr(e,o[o.length-1],i[i.length-1]),l=_r(e,n.path);return [t,c,a,l,r]}function Mr(e,n){let r=Re(e.canvas),t=n[0],o=[],i=[];for(let c=1;c<n.length;c++){let a=n[c],l=We(e,t),h=We(e,a);if(jt(l,h)){t=a;continue}let d=Le(t,a),u=kr(r,l,h,1,-1,e.config.useAscii);u.length===0&&u.push(l),o.push(u),i.push(d),t=a;}return [r,o,i]}function Cr(e,n,r){let t=Re(e.canvas);if(e.config.useAscii)return t;let o=r[0],i=Le(n[0],n[1]);return q(i,ie)?t[o.x][o.y+1]="\u2534":q(i,ne)?t[o.x][o.y-1]="\u252C":q(i,se)?t[o.x+1][o.y]="\u2524":q(i,re)&&(t[o.x-1][o.y]="\u251C"),t}function Sr(e,n,r){let t=Re(e.canvas);if(n.length===0)return t;let o=n[0],i=n[n.length-1],c=Le(o,i);(n.length===1||q(c,Qe))&&(c=r);let a;return e.config.useAscii?q(c,ie)?a="^":q(c,ne)?a="v":q(c,se)?a="<":q(c,re)?a=">":q(r,ie)?a="^":q(r,ne)?a="v":q(r,se)?a="<":q(r,re)?a=">":a="*":q(c,ie)?a="\u25B2":q(c,ne)?a="\u25BC":q(c,se)?a="\u25C4":q(c,re)?a="\u25BA":q(c,be)?a="\u25E5":q(c,xe)?a="\u25E4":q(c,$e)?a="\u25E2":q(c,we)?a="\u25E3":q(r,ie)?a="\u25B2":q(r,ne)?a="\u25BC":q(r,se)?a="\u25C4":q(r,re)?a="\u25BA":q(r,be)?a="\u25E5":q(r,xe)?a="\u25E4":q(r,$e)?a="\u25E2":q(r,we)?a="\u25E3":a="\u25CF",t[i.x][i.y]=a,t}function _r(e,n){let r=Re(e.canvas);for(let t=1;t<n.length-1;t++){let o=n[t],i=We(e,o),c=Le(n[t-1],o),a=Le(o,n[t+1]),l;e.config.useAscii?l="+":q(c,re)&&q(a,ne)||q(c,ie)&&q(a,se)?l="\u2510":q(c,re)&&q(a,ie)||q(c,ne)&&q(a,se)?l="\u2518":q(c,se)&&q(a,ne)||q(c,ie)&&q(a,re)?l="\u250C":q(c,se)&&q(a,ie)||q(c,ne)&&q(a,re)?l="\u2514":l="+",r[i.x][i.y]=l;}return r}function Ar(e,n){let r=Re(e.canvas);if(n.text.length===0)return r;let t=nn(e,n.labelLine);return Lr(r,t,n.text),r}function Lr(e,n,r){if(n.length<2)return;let t=Math.min(n[0].x,n[1].x),o=Math.max(n[0].x,n[1].x),i=Math.min(n[0].y,n[1].y),c=Math.max(n[0].y,n[1].y),a=t+Math.floor((o-t)/2),l=i+Math.floor((c-i)/2),h=a-Math.floor(r.length/2);Ut(e,{x:h,y:l},r);}function Pr(e,n){let r=e.maxX-e.minX,t=e.maxY-e.minY;if(r<=0||t<=0)return he(0,0);let o={x:0,y:0},i={x:r,y:t},c=he(r,t);if(n.config.useAscii){for(let a=o.x+1;a<i.x;a++)c[a][o.y]="-";for(let a=o.x+1;a<i.x;a++)c[a][i.y]="-";for(let a=o.y+1;a<i.y;a++)c[o.x][a]="|";for(let a=o.y+1;a<i.y;a++)c[i.x][a]="|";c[o.x][o.y]="+",c[i.x][o.y]="+",c[o.x][i.y]="+",c[i.x][i.y]="+";}else {for(let a=o.x+1;a<i.x;a++)c[a][o.y]="\u2500";for(let a=o.x+1;a<i.x;a++)c[a][i.y]="\u2500";for(let a=o.y+1;a<i.y;a++)c[o.x][a]="\u2502";for(let a=o.y+1;a<i.y;a++)c[i.x][a]="\u2502";c[o.x][o.y]="\u250C",c[i.x][o.y]="\u2510",c[o.x][i.y]="\u2514",c[i.x][i.y]="\u2518";}return c}function Dr(e,n){let r=e.maxX-e.minX,t=e.maxY-e.minY;if(r<=0||t<=0)return [he(0,0),{x:0,y:0}];let o=he(r,t),i=1,c=Math.floor(r/2)-Math.floor(e.name.length/2);c<1&&(c=1);for(let a=0;a<e.name.length;a++)c+a<r&&(o[c+a][i]=e.name[a]);return [o,{x:e.minX,y:e.minY}]}function Tr(e){function n(t){return t.parent===null?0:1+n(t.parent)}let r=[...e];return r.sort((t,o)=>n(t)-n(o)),r}function tn(e){let n=e.config.useAscii,r=Tr(e.subgraphs);for(let h of r){let d=Pr(h,e),u={x:h.minX,y:h.minY};e.canvas=ke(e.canvas,u,n,d);}for(let h of e.nodes)!h.drawn&&h.drawingCoord&&h.drawing&&(e.canvas=ke(e.canvas,h.drawingCoord,n,h.drawing),h.drawn=true);let t=[],o=[],i=[],c=[],a=[];for(let h of e.edges){let[d,u,s,f,p]=Er(e,h);t.push(d),o.push(f),i.push(s),c.push(u),a.push(p);}let l={x:0,y:0};e.canvas=ke(e.canvas,l,n,...t),e.canvas=ke(e.canvas,l,n,...o),e.canvas=ke(e.canvas,l,n,...i),e.canvas=ke(e.canvas,l,n,...c),e.canvas=ke(e.canvas,l,n,...a);for(let h of e.subgraphs){if(h.nodes.length===0)continue;let[d,u]=Dr(h);e.canvas=ke(e.canvas,u,n,d);}return e.canvas}function We(e,n,r){let t=n,o=0;for(let l=0;l<t.x;l++)o+=e.columnWidth.get(l)??0;let i=0;for(let l=0;l<t.y;l++)i+=e.rowHeight.get(l)??0;let c=e.columnWidth.get(t.x)??0,a=e.rowHeight.get(t.y)??0;return {x:o+Math.floor(c/2)+e.offsetX,y:i+Math.floor(a/2)+e.offsetY}}function nn(e,n){return n.map(r=>We(e,r))}function Ue(e,n,r){if(e.grid.has(ve(r)))return e.config.graphDirection==="LR"?Ue(e,n,{x:r.x,y:r.y+4}):Ue(e,n,{x:r.x+4,y:r.y});for(let t=0;t<3;t++)for(let o=0;o<3;o++){let i={x:r.x+t,y:r.y+o};e.grid.set(ve(i),n);}return n.gridCoord=r,r}function Rr(e,n){let r=n.gridCoord,t=e.config.boxBorderPadding,o=[1,2*t+n.displayLabel.length,1],i=[1,1+2*t,1];for(let c=0;c<o.length;c++){let a=r.x+c,l=e.columnWidth.get(a)??0;e.columnWidth.set(a,Math.max(l,o[c]));}for(let c=0;c<i.length;c++){let a=r.y+c,l=e.rowHeight.get(a)??0;e.rowHeight.set(a,Math.max(l,i[c]));}if(r.x>0){let c=e.columnWidth.get(r.x-1)??0;e.columnWidth.set(r.x-1,Math.max(c,e.config.paddingX));}if(r.y>0){let c=e.config.paddingY;Nr(e,n)&&(c+=4);let a=e.rowHeight.get(r.y-1)??0;e.rowHeight.set(r.y-1,Math.max(a,c));}}function Ir(e,n){for(let r of n)e.columnWidth.has(r.x)||e.columnWidth.set(r.x,Math.floor(e.config.paddingX/2)),e.rowHeight.has(r.y)||e.rowHeight.set(r.y,Math.floor(e.config.paddingY/2));}function wt(e,n){return e.subgraphs.some(r=>r.nodes.includes(n))}function vt(e,n){for(let r of e.subgraphs)if(r.nodes.includes(n))return r;return null}function Nr(e,n){let r=vt(e,n);if(!r)return  false;let t=false;for(let o of e.edges)if(o.to===n&&vt(e,o.from)!==r){t=true;break}if(!t)return  false;for(let o of r.nodes){if(o===n||!o.gridCoord)continue;let i=false;for(let c of e.edges)if(c.to===o&&vt(e,c.from)!==r){i=true;break}if(i&&o.gridCoord.y<n.gridCoord.y)return  false}return  true}function rn(e,n){if(n.nodes.length===0)return;let r=1e6,t=1e6,o=-1e6,i=-1e6;for(let l of n.children)rn(e,l),l.nodes.length>0&&(r=Math.min(r,l.minX),t=Math.min(t,l.minY),o=Math.max(o,l.maxX),i=Math.max(i,l.maxY));for(let l of n.nodes){if(!l.drawingCoord||!l.drawing)continue;let h=l.drawingCoord.x,d=l.drawingCoord.y,u=h+l.drawing.length-1,s=d+l.drawing[0].length-1;r=Math.min(r,h),t=Math.min(t,d),o=Math.max(o,u),i=Math.max(i,s);}let c=2,a=2;n.minX=r-c,n.minY=t-c-a,n.maxX=o+c,n.maxY=i+c;}function Gr(e){let r=e.subgraphs.filter(t=>t.parent===null&&t.nodes.length>0);for(let t=0;t<r.length;t++)for(let o=t+1;o<r.length;o++){let i=r[t],c=r[o];i.minX<c.maxX&&i.maxX>c.minX&&(i.maxY>=c.minY-1&&i.minY<c.minY?c.minY=i.maxY+1+1:c.maxY>=i.minY-1&&c.minY<i.minY&&(i.minY=c.maxY+1+1)),i.minY<c.maxY&&i.maxY>c.minY&&(i.maxX>=c.minX-1&&i.minX<c.minX?c.minX=i.maxX+1+1:c.maxX>=i.minX-1&&c.minX<i.minX&&(i.minX=c.maxX+1+1));}}function Or(e){for(let n of e.subgraphs)rn(e,n);Gr(e);}function Wr(e){if(e.subgraphs.length===0)return;let n=0,r=0;for(let i of e.subgraphs)n=Math.min(n,i.minX),r=Math.min(r,i.minY);let t=-n,o=-r;if(!(t===0&&o===0)){e.offsetX=t,e.offsetY=o;for(let i of e.subgraphs)i.minX+=t,i.minY+=o,i.maxX+=t,i.maxY+=o;for(let i of e.nodes)i.drawingCoord&&(i.drawingCoord.x+=t,i.drawingCoord.y+=o);}}function on(e){let n=e.config.graphDirection,r=new Array(100).fill(0),t=new Set,o=[];for(let d of e.nodes){t.has(d.name)||o.push(d),t.add(d.name);for(let u of $t(e,d))t.add(u.name);}let i=false,c=false;for(let d of o)wt(e,d)?$t(e,d).length>0&&(c=true):i=true;let a=n==="LR"&&i&&c,l,h=[];a?(l=o.filter(d=>!wt(e,d)),h=o.filter(d=>wt(e,d))):l=o;for(let d of l){let u=n==="LR"?{x:0,y:r[0]}:{x:r[0],y:0};Ue(e,e.nodes[d.index],u),r[0]=r[0]+4;}if(a&&h.length>0)for(let u of h){let s=n==="LR"?{x:4,y:r[4]}:{x:r[4],y:4};Ue(e,e.nodes[u.index],s),r[4]=r[4]+4;}for(let d of e.nodes){let u=d.gridCoord,s=n==="LR"?u.x+4:u.y+4,f=r[s];for(let p of $t(e,d)){if(p.gridCoord!==null)continue;let x=n==="LR"?{x:s,y:f}:{x:f,y:s};Ue(e,e.nodes[p.index],x),r[s]=f+4,f=r[s];}}for(let d of e.nodes)Rr(e,d);for(let d of e.edges)Zt(e,d),Ir(e,d.path),Qt(e,d);for(let d of e.nodes)d.drawingCoord=We(e,d.gridCoord),d.drawing=en(d,e);qt(e.canvas,e.columnWidth,e.rowHeight),Or(e),Wr(e);}function Hr(e,n){return e.edges.filter(r=>r.from.name===n.name)}function $t(e,n){return Hr(e,n).map(r=>r.to)}function nt(e){let n={actors:[],messages:[],blocks:[],notes:[]},r=new Set,t=[];for(let o=1;o<e.length;o++){let i=e[o],c=i.match(/^(participant|actor)\s+(\S+?)(?:\s+as\s+(.+))?$/);if(c){let s=c[1],f=c[2],p=c[3]?.trim()??f;r.has(f)||(r.add(f),n.actors.push({id:f,label:p,type:s}));continue}let a=i.match(/^Note\s+(left of|right of|over)\s+([^:]+):\s*(.+)$/i);if(a){let s=a[1].toLowerCase(),f=a[2].trim(),p=a[3].trim(),x=f.split(",").map(m=>m.trim());for(let m of x)qe(n,r,m);let g="over";s==="left of"?g="left":s==="right of"&&(g="right"),n.notes.push({actorIds:x,text:p,position:g,afterIndex:n.messages.length-1});continue}let l=i.match(/^(loop|alt|opt|par|critical|break|rect)\s*(.*)$/);if(l){let s=l[1],f=l[2]?.trim()??"";t.push({type:s,label:f,startIndex:n.messages.length,dividers:[]});continue}let h=i.match(/^(else|and)\s*(.*)$/);if(h&&t.length>0){let s=h[2]?.trim()??"";t[t.length-1].dividers.push({index:n.messages.length,label:s});continue}if(i==="end"&&t.length>0){let s=t.pop();n.blocks.push({type:s.type,label:s.label,startIndex:s.startIndex,endIndex:Math.max(n.messages.length-1,s.startIndex),dividers:s.dividers});continue}let d=i.match(/^(\S+?)\s*(--?>?>|--?[)x]|--?>>|--?>)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(d){let s=d[1],f=d[2],p=d[3],x=d[4],g=d[5].trim();qe(n,r,s),qe(n,r,x);let m=f.startsWith("--")?"dashed":"solid",v=f.includes(">>")||f.includes("x")?"filled":"open",$={from:s,to:x,label:g,lineStyle:m,arrowHead:v};p==="+"&&($.activate=true),p==="-"&&($.deactivate=true),n.messages.push($);continue}let u=i.match(/^(\S+?)\s*(->>|-->>|-\)|--\)|-x|--x|->|-->)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(u){let s=u[1],f=u[2],p=u[3],x=u[4],g=u[5].trim();qe(n,r,s),qe(n,r,x);let m=f.startsWith("--")?"dashed":"solid",v=f.includes(">>")||f.includes("x")?"filled":"open",$={from:s,to:x,label:g,lineStyle:m,arrowHead:v};p==="+"&&($.activate=true),p==="-"&&($.deactivate=true),n.messages.push($);continue}}return n}function qe(e,n,r){n.has(r)||(n.add(r),e.actors.push({id:r,label:r,type:"participant"}));}function sn(e,n){let r=e.split(`
`).map(P=>P.trim()).filter(P=>P.length>0&&!P.startsWith("%%")),t=nt(r);if(t.actors.length===0)return "";let o=n.useAscii,i=o?"-":"\u2500",c=o?"|":"\u2502",a=o?"+":"\u250C",l=o?"+":"\u2510",h=o?"+":"\u2514",d=o?"+":"\u2518",u=o?"+":"\u252C",s=o?"+":"\u2534",f=o?"+":"\u251C",p=o?"+":"\u2524",x=new Map;t.actors.forEach((P,j)=>x.set(P.id,j));let g=1,v=t.actors.map(P=>P.label.length+2*g+2).map(P=>Math.ceil(P/2)),$=3,M=new Array(Math.max(t.actors.length-1,0)).fill(0);for(let P of t.messages){let j=x.get(P.from),B=x.get(P.to);if(j===B)continue;let X=Math.min(j,B),Y=Math.max(j,B),H=P.label.length+4,F=Y-X,V=Math.ceil(H/F);for(let _=X;_<Y;_++)M[_]=Math.max(M[_],V);}let L=[v[0]];for(let P=1;P<t.actors.length;P++){let j=Math.max(v[P-1]+v[P]+2,M[P-1]+2,10);L[P]=L[P-1]+j;}let y=[],b=[],w=new Map,E=new Map,G=new Map,O=[],I=$;for(let P=0;P<t.messages.length;P++){for(let X=0;X<t.blocks.length;X++)t.blocks[X].startIndex===P&&(I+=2,w.set(X,I-1));for(let X=0;X<t.blocks.length;X++)for(let Y=0;Y<t.blocks[X].dividers.length;Y++)t.blocks[X].dividers[Y].index===P&&(I+=1,G.set(`${X}:${Y}`,I),I+=1);I+=1;let j=t.messages[P];j.from===j.to?(b[P]=I+1,y[P]=I,I+=3):(b[P]=I,y[P]=I+1,I+=2);for(let X=0;X<t.notes.length;X++)if(t.notes[X].afterIndex===P){I+=1;let Y=t.notes[X],H=Y.text.split("\\n"),F=Math.max(...H.map(N=>N.length))+4,V=H.length+2,_=x.get(Y.actorIds[0])??0,D;if(Y.position==="left")D=L[_]-F-1;else if(Y.position==="right")D=L[_]+2;else if(Y.actorIds.length>=2){let N=x.get(Y.actorIds[1])??_;D=Math.floor((L[_]+L[N])/2)-Math.floor(F/2);}else D=L[_]-Math.floor(F/2);D=Math.max(0,D),O.push({x:D,y:I,width:F,height:V,lines:H}),I+=V;}for(let X=0;X<t.blocks.length;X++)t.blocks[X].endIndex===P&&(I+=1,E.set(X,I),I+=1);}I+=1;let R=I,k=R+$,S=L[L.length-1]??0,T=v[v.length-1]??0,A=S+T+2;for(let P=0;P<t.messages.length;P++){let j=t.messages[P];if(j.from===j.to){let B=x.get(j.from),X=L[B]+6+2+j.label.length;A=Math.max(A,X+1);}}for(let P of O)A=Math.max(A,P.x+P.width+1);let C=he(A,k-1);function W(P,j,B){let X=B.length+2*g+2,Y=P-Math.floor(X/2);C[Y][j]=a;for(let F=1;F<X-1;F++)C[Y+F][j]=i;C[Y+X-1][j]=l,C[Y][j+1]=c,C[Y+X-1][j+1]=c;let H=Y+1+g;for(let F=0;F<B.length;F++)C[H+F][j+1]=B[F];C[Y][j+2]=h;for(let F=1;F<X-1;F++)C[Y+F][j+2]=i;C[Y+X-1][j+2]=d;}for(let P=0;P<t.actors.length;P++){let j=L[P];for(let B=$;B<=R;B++)C[j][B]=c;}for(let P=0;P<t.actors.length;P++){let j=t.actors[P];W(L[P],0,j.label),W(L[P],R,j.label),o||(C[L[P]][$-1]=u,C[L[P]][R]=s);}for(let P=0;P<t.messages.length;P++){let j=t.messages[P],B=x.get(j.from),X=x.get(j.to),Y=L[B],H=L[X],F=B===X,V=j.lineStyle==="dashed",_=j.arrowHead==="filled",D=V?o?".":"\u254C":i;if(F){let N=y[P],z=Math.max(4,4);C[Y][N]=f;for(let J=Y+1;J<Y+z;J++)C[J][N]=D;C[Y+z][N]=o?"+":"\u2510",C[Y+z][N+1]=c;let K=Y+z+2;for(let J=0;J<j.label.length;J++)K+J<A&&(C[K+J][N+1]=j.label[J]);let ee=_?o?"<":"\u25C0":o?"<":"\u25C1";C[Y][N+2]=ee;for(let J=Y+1;J<Y+z;J++)C[J][N+2]=D;C[Y+z][N+2]=o?"+":"\u2518";}else {let N=b[P],z=y[P],K=Y<H,J=Math.floor((Y+H)/2)-Math.floor(j.label.length/2);for(let ce=0;ce<j.label.length;ce++){let fe=J+ce;fe>=0&&fe<A&&(C[fe][N]=j.label[ce]);}if(K){for(let fe=Y+1;fe<H;fe++)C[fe][z]=D;let ce=_?o?">":"\u25B6":o?">":"\u25B7";C[H][z]=ce;}else {for(let fe=H+1;fe<Y;fe++)C[fe][z]=D;let ce=_?o?"<":"\u25C0":o?"<":"\u25C1";C[H][z]=ce;}}}for(let P=0;P<t.blocks.length;P++){let j=t.blocks[P],B=w.get(P),X=E.get(P);if(B===void 0||X===void 0)continue;let Y=A,H=0;for(let D=j.startIndex;D<=j.endIndex&&!(D>=t.messages.length);D++){let N=t.messages[D],z=x.get(N.from)??0,K=x.get(N.to)??0;Y=Math.min(Y,L[Math.min(z,K)]),H=Math.max(H,L[Math.max(z,K)]);}let F=Math.max(0,Y-4),V=Math.min(A-1,H+4);C[F][B]=a;for(let D=F+1;D<V;D++)C[D][B]=i;C[V][B]=l;let _=j.label?`${j.type} [${j.label}]`:j.type;for(let D=0;D<_.length&&F+1+D<V;D++)C[F+1+D][B]=_[D];C[F][X]=h;for(let D=F+1;D<V;D++)C[D][X]=i;C[V][X]=d;for(let D=B+1;D<X;D++)C[F][D]=c,C[V][D]=c;for(let D=0;D<j.dividers.length;D++){let N=G.get(`${P}:${D}`);if(N===void 0)continue;let z=U();C[F][N]=f;for(let ee=F+1;ee<V;ee++)C[ee][N]=z;C[V][N]=p;let K=j.dividers[D].label;if(K){let ee=`[${K}]`;for(let J=0;J<ee.length&&F+1+J<V;J++)C[F+1+J][N]=ee[J];}}}for(let P of O){_e(C,P.x+P.width,P.y+P.height),C[P.x][P.y]=a;for(let B=1;B<P.width-1;B++)C[P.x+B][P.y]=i;C[P.x+P.width-1][P.y]=l;for(let B=0;B<P.lines.length;B++){let X=P.y+1+B;C[P.x][X]=c,C[P.x+P.width-1][X]=c;for(let Y=0;Y<P.lines[B].length;Y++)C[P.x+2+Y][X]=P.lines[B][Y];}let j=P.y+P.height-1;C[P.x][j]=h;for(let B=1;B<P.width-1;B++)C[P.x+B][j]=i;C[P.x+P.width-1][j]=d;}return Ae(C);function U(){return o?"-":"\u254C"}}function rt(e){let n={classes:[],relationships:[],namespaces:[]},r=new Map,t=null,o=null,i=0;for(let c=1;c<e.length;c++){let a=e[c];if(o&&i>0){if(a==="}"){i--,i===0&&(o=null);continue}let p=a.match(/^<<(\w+)>>$/);if(p){o.annotation=p[1];continue}let x=an(a);x&&(x.isMethod?o.methods.push(x.member):o.attributes.push(x.member));continue}let l=a.match(/^namespace\s+(\S+)\s*\{$/);if(l){t={name:l[1],classIds:[]};continue}if(a==="}"&&t){n.namespaces.push(t),t=null;continue}let h=a.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*\{$/);if(h){let p=h[1],x=h[2],g=He(r,p);x&&(g.label=`${p}<${x}>`),o=g,i=1,t&&t.classIds.push(p);continue}let d=a.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*$/);if(d){let p=d[1],x=d[2],g=He(r,p);x&&(g.label=`${p}<${x}>`),t&&t.classIds.push(p);continue}let u=a.match(/^class\s+(\S+?)\s*\{\s*<<(\w+)>>\s*\}$/);if(u){let p=He(r,u[1]);p.annotation=u[2];continue}let s=a.match(/^(\S+?)\s*:\s*(.+)$/);if(s){let p=s[2];if(!p.match(/<\|--|--|\*--|o--|-->|\.\.>|\.\.\|>/)){let x=He(r,s[1]),g=an(p);g&&(g.isMethod?x.methods.push(g.member):x.attributes.push(g.member));continue}}let f=Yr(a);if(f){He(r,f.from),He(r,f.to),n.relationships.push(f);continue}}return n.classes=[...r.values()],n}function He(e,n){let r=e.get(n);return r||(r={id:n,label:n,attributes:[],methods:[]},e.set(n,r)),r}function an(e){let n=e.trim().replace(/;$/,"");if(!n)return null;let r="",t=n;/^[+\-#~]/.test(t)&&(r=t[0],t=t.slice(1).trim());let o=t.match(/^(.+?)\(([^)]*)\)(?:\s*(.+))?$/);if(o){let d=o[1].trim(),u=o[3]?.trim(),s=d.endsWith("$")||t.includes("$"),f=d.endsWith("*")||t.includes("*");return {member:{visibility:r,name:d.replace(/[$*]$/,""),type:u||void 0,isStatic:s,isAbstract:f},isMethod:true}}let i=t.split(/\s+/),c,a;i.length>=2?(a=i[0],c=i.slice(1).join(" ")):c=i[0]??t;let l=c.endsWith("$"),h=c.endsWith("*");return {member:{visibility:r,name:c.replace(/[$*]$/,""),type:a||void 0,isStatic:l,isAbstract:h},isMethod:false}}function Yr(e){let n=e.match(/^(\S+?)\s+(?:"([^"]*?)"\s+)?(<\|--|<\|\.\.|\*--|o--|-->|--\*|--o|--|>\s*|\.\.>|\.\.\|>|--)\s+(?:"([^"]*?)"\s+)?(\S+?)(?:\s*:\s*(.+))?$/);if(!n)return null;let r=n[1],t=n[2]||void 0,o=n[3].trim(),i=n[4]||void 0,c=n[5],a=n[6]?.trim()||void 0,l=Xr(o);return l?{from:r,to:c,type:l.type,markerAt:l.markerAt,label:a,fromCardinality:t,toCardinality:i}:null}function Xr(e){switch(e){case "<|--":return {type:"inheritance",markerAt:"from"};case "<|..":return {type:"realization",markerAt:"from"};case "*--":return {type:"composition",markerAt:"from"};case "--*":return {type:"composition",markerAt:"to"};case "o--":return {type:"aggregation",markerAt:"from"};case "--o":return {type:"aggregation",markerAt:"to"};case "-->":return {type:"association",markerAt:"to"};case "..>":return {type:"dependency",markerAt:"to"};case "..|>":return {type:"realization",markerAt:"to"};case "--":return {type:"association",markerAt:"to"};default:return null}}function cn(e){let n=e.visibility||"",r=e.type?`: ${e.type}`:"";return `${n}${e.name}${r}`}function Br(e){let n=[];e.annotation&&n.push(`<<${e.annotation}>>`),n.push(e.label);let r=e.attributes.map(cn),t=e.methods.map(cn);return r.length===0&&t.length===0?[n]:t.length===0?[n,r]:[n,r,t]}function jr(e,n){return {type:e,markerAt:n,dashed:e==="dependency"||e==="realization"}}function Ye(e,n,r){switch(e){case "inheritance":case "realization":return r==="down"?n?"^":"\u25B3":r==="up"?n?"v":"\u25BD":r==="left"?n?">":"\u25C1":n?"<":"\u25B7";case "composition":return n?"*":"\u25C6";case "aggregation":return n?"o":"\u25C7";case "association":case "dependency":return r==="down"?n?"v":"\u25BC":r==="up"?n?"^":"\u25B2":r==="left"?n?"<":"\u25C0":n?">":"\u25B6"}}function ln(e,n){let r=e.split(`
`).map(R=>R.trim()).filter(R=>R.length>0&&!R.startsWith("%%")),t=rt(r);if(t.classes.length===0)return "";let o=n.useAscii,i=4,c=3,a=new Map,l=new Map,h=new Map;for(let R of t.classes){let k=Br(R);a.set(R.id,k);let S=0;for(let W of k)for(let U of W)S=Math.max(S,U.length);let T=S+4,A=0;for(let W of k)A+=Math.max(W.length,1);let C=A+(k.length-1)+2;l.set(R.id,T),h.set(R.id,C);}let d=new Map;for(let R of t.classes)d.set(R.id,R);let u=new Map,s=new Map;for(let R of t.relationships){let k=R.type==="inheritance"||R.type==="realization",S=k&&R.markerAt==="to"?R.to:R.from,T=k&&R.markerAt==="to"?R.from:R.to;u.has(T)||u.set(T,new Set),u.get(T).add(S),s.has(S)||s.set(S,new Set),s.get(S).add(T);}let f=new Map,x=t.classes.filter(R=>!u.has(R.id)||u.get(R.id).size===0).map(R=>R.id);for(let R of x)f.set(R,0);let g=t.classes.length-1,m=0;for(;m<x.length;){let R=x[m++],k=s.get(R);if(k)for(let S of k){let T=(f.get(R)??0)+1;T>g||(!f.has(S)||f.get(S)<T)&&(f.set(S,T),x.push(S));}}for(let R of t.classes)f.has(R.id)||f.set(R.id,0);let v=Math.max(...f.values(),0),$=Array.from({length:v+1},()=>[]);for(let R of t.classes)$[f.get(R.id)].push(R.id);let M=new Map,L=0;for(let R=0;R<=v;R++){let k=$[R];if(k.length===0)continue;let S=0,T=0;for(let A of k){let C=d.get(A),W=l.get(A),U=h.get(A);M.set(A,{cls:C,sections:a.get(A),x:S,y:L,width:W,height:U}),S+=W+i,T=Math.max(T,U);}L+=T+c;}let y=0,b=0;for(let R of M.values())y=Math.max(y,R.x+R.width),b=Math.max(b,R.y+R.height);y+=4,b+=2;let w=he(y-1,b-1);for(let R of M.values()){let k=tt(R.sections,o);for(let S=0;S<k.length;S++)for(let T=0;T<k[0].length;T++){let A=k[S][T];if(A!==" "){let C=R.x+S,W=R.y+T;C<y&&W<b&&(w[C][W]=A);}}}let E=o?"-":"\u2500",G=o?"|":"\u2502",O=o?".":"\u254C",I=o?":":"\u250A";for(let R of t.relationships){let k=M.get(R.from),S=M.get(R.to);if(!k||!S)continue;let T=jr(R.type,R.markerAt),A=T.dashed?O:E,C=T.dashed?I:G,W=k.x+Math.floor(k.width/2),U=k.y+k.height-1,P=S.x+Math.floor(S.width/2),j=S.y;if(U<j){let B=U+Math.floor((j-U)/2);for(let X=U+1;X<=B;X++)X<b&&(w[W][X]=C);if(W!==P){let X=Math.min(W,P),Y=Math.max(W,P);for(let H=X;H<=Y;H++)H<y&&B<b&&(w[H][B]=A);!o&&B<b&&(W<P?(w[W][B]="\u2514",w[P][B]="\u2510"):(w[W][B]="\u2518",w[P][B]="\u250C"));}for(let X=B+1;X<j;X++)X<b&&(w[P][X]=C);if(T.markerAt==="to"){let X=Ye(T.type,o,"down"),Y=j-1;if(Y>=0&&Y<b)for(let H=0;H<X.length;H++){let F=P-Math.floor(X.length/2)+H;F>=0&&F<y&&(w[F][Y]=X[H]);}}if(T.markerAt==="from"){let X=Ye(T.type,o,"down"),Y=U+1;if(Y<b)for(let H=0;H<X.length;H++){let F=W-Math.floor(X.length/2)+H;F>=0&&F<y&&(w[F][Y]=X[H]);}}}else if(S.y+S.height-1<k.y){let B=k.y,X=S.y+S.height-1,Y=X+Math.floor((B-X)/2);for(let H=B-1;H>=Y;H--)H>=0&&H<b&&(w[W][H]=C);if(W!==P){let H=Math.min(W,P),F=Math.max(W,P);for(let V=H;V<=F;V++)V<y&&Y>=0&&Y<b&&(w[V][Y]=A);!o&&Y>=0&&Y<b&&(W<P?(w[W][Y]="\u250C",w[P][Y]="\u2518"):(w[W][Y]="\u2510",w[P][Y]="\u2514"));}for(let H=Y-1;H>X;H--)H>=0&&H<b&&(w[P][H]=C);if(T.markerAt==="from"){let H=Ye(T.type,o,"up"),F=B-1;if(F>=0&&F<b)for(let V=0;V<H.length;V++){let _=W-Math.floor(H.length/2)+V;_>=0&&_<y&&(w[_][F]=H[V]);}}if(T.markerAt==="to"){let F=T.type==="inheritance"||T.type==="realization"?"down":"up",V=Ye(T.type,o,F),_=X+1;if(_<b)for(let D=0;D<V.length;D++){let N=P-Math.floor(V.length/2)+D;N>=0&&N<y&&(w[N][_]=V[D]);}}}else {let B=Math.max(U,S.y+S.height-1)+2;_e(w,y,B+1);for(let H=U+1;H<=B;H++)w[W][H]=C;let X=Math.min(W,P),Y=Math.max(W,P);for(let H=X;H<=Y;H++)w[H][B]=A;for(let H=B-1;H>=S.y+S.height;H--)w[P][H]=C;if(T.markerAt==="from"){let H=Ye(T.type,o,"down"),F=U+1;if(F<b)for(let V=0;V<H.length;V++){let _=W-Math.floor(H.length/2)+V;_>=0&&_<y&&(w[_][F]=H[V]);}}if(T.markerAt==="to"){let H=Ye(T.type,o,"up"),F=S.y+S.height;if(F<b)for(let V=0;V<H.length;V++){let _=P-Math.floor(H.length/2)+V;_>=0&&_<y&&(w[_][F]=H[V]);}}}if(R.label){let B=` ${R.label} `,X=Math.floor((W+P)/2),Y;if(U<j)Y=Math.floor((U+1+j-1)/2);else if(S.y+S.height-1<k.y){let F=S.y+S.height-1;Y=Math.floor((F+1+k.y-1)/2);}else Y=Math.max(U,S.y+S.height-1)+2;let H=X-Math.floor(B.length/2);for(let F=0;F<B.length;F++){let V=H+F;V>=0&&V<y&&Y>=0&&Y<b&&(w[V][Y]=B[F]);}}}return Ae(w)}function ot(e){let n={entities:[],relationships:[]},r=new Map,t=null;for(let o=1;o<e.length;o++){let i=e[o];if(t){if(i==="}"){t=null;continue}let l=Fr(i);l&&t.attributes.push(l);continue}let c=i.match(/^(\S+)\s*\{$/);if(c){let l=c[1];t=kt(r,l);continue}let a=zr(i);if(a){kt(r,a.entity1),kt(r,a.entity2),n.relationships.push(a);continue}}return n.entities=[...r.values()],n}function kt(e,n){let r=e.get(n);return r||(r={id:n,label:n,attributes:[]},e.set(n,r)),r}function Fr(e){let n=e.match(/^(\S+)\s+(\S+)(?:\s+(.+))?$/);if(!n)return null;let r=n[1],t=n[2],o=n[3]?.trim()??"",i=[],c,a=o.match(/"([^"]*)"/);a&&(c=a[1]);let l=o.replace(/"[^"]*"/,"").trim();for(let h of l.split(/\s+/)){let d=h.toUpperCase();(d==="PK"||d==="FK"||d==="UK")&&i.push(d);}return {type:r,name:t,keys:i,comment:c}}function zr(e){let n=e.match(/^(\S+)\s+([|o}{]+(?:--|\.\.)[|o}{]+)\s+(\S+)\s*:\s*(.+)$/);if(!n)return null;let r=n[1],t=n[2],o=n[3],i=n[4].trim(),c=t.match(/^([|o}{]+)(--|\.\.?)([|o}{]+)$/);if(!c)return null;let a=c[1],l=c[2],h=c[3],d=dn(a),u=dn(h),s=l==="--";return !d||!u?null:{entity1:r,entity2:o,cardinality1:d,cardinality2:u,label:i,identifying:s}}function dn(e){let n=e.split("").sort().join("");return n==="||"?"one":n==="o|"?"zero-one":n==="|}"||n==="{|"?"many":n==="{o"||n==="o{"?"zero-many":null}function Vr(e){return `${e.keys.length>0?e.keys.join(",")+" ":"   "}${e.type} ${e.name}`}function Ur(e){let n=[e.label],r=e.attributes.map(Vr);return r.length===0?[n]:[n,r]}function it(e,n){if(n)switch(e){case "one":return "||";case "zero-one":return "o|";case "many":return "}|";case "zero-many":return "o{"}else switch(e){case "one":return "\u2551";case "zero-one":return "o\u2551";case "many":return "\u255F";case "zero-many":return "o\u255F"}}function hn(e,n){let r=e.split(`
`).map(b=>b.trim()).filter(b=>b.length>0&&!b.startsWith("%%")),t=ot(r);if(t.entities.length===0)return "";let o=n.useAscii,i=6,c=4,a=new Map,l=new Map,h=new Map;for(let b of t.entities){let w=Ur(b);a.set(b.id,w);let E=0;for(let R of w)for(let k of R)E=Math.max(E,k.length);let G=E+4,O=0;for(let R of w)O+=Math.max(R.length,1);let I=O+(w.length-1)+2;l.set(b.id,G),h.set(b.id,I);}let d=Math.max(2,Math.ceil(Math.sqrt(t.entities.length))),u=new Map,s=0,f=0,p=0,x=0;for(let b of t.entities){let w=l.get(b.id),E=h.get(b.id);x>=d&&(f+=p+c,s=0,p=0,x=0),u.set(b.id,{entity:b,sections:a.get(b.id),x:s,y:f,width:w,height:E}),s+=w+i,p=Math.max(p,E),x++;}let g=0,m=0;for(let b of u.values())g=Math.max(g,b.x+b.width),m=Math.max(m,b.y+b.height);g+=4,m+=2;let v=he(g-1,m-1);for(let b of u.values()){let w=tt(b.sections,o);for(let E=0;E<w.length;E++)for(let G=0;G<w[0].length;G++){let O=w[E][G];if(O!==" "){let I=b.x+E,R=b.y+G;I<g&&R<m&&(v[I][R]=O);}}}let $=o?"-":"\u2500",M=o?"|":"\u2502",L=o?".":"\u254C",y=o?":":"\u250A";for(let b of t.relationships){let w=u.get(b.entity1),E=u.get(b.entity2);if(!w||!E)continue;let G=b.identifying?$:L,O=b.identifying?M:y,I=w.x+Math.floor(w.width/2),R=w.y+Math.floor(w.height/2),k=E.x+Math.floor(E.width/2),S=E.y+Math.floor(E.height/2);if(Math.abs(R-S)<Math.max(w.height,E.height)){let[A,C]=I<k?[w,E]:[E,w],[W,U]=I<k?[b.cardinality1,b.cardinality2]:[b.cardinality2,b.cardinality1],P=A.x+A.width,j=C.x-1,B=A.y+Math.floor(A.height/2);for(let H=P;H<=j;H++)H<g&&(v[H][B]=G);let X=it(W,o);for(let H=0;H<X.length;H++){let F=P+H;F<g&&(v[F][B]=X[H]);}let Y=it(U,o);for(let H=0;H<Y.length;H++){let F=j-Y.length+1+H;F>=0&&F<g&&(v[F][B]=Y[H]);}if(b.label){let H=Math.floor((P+j)/2),F=Math.max(P,H-Math.floor(b.label.length/2)),V=B-1;if(V>=0)for(let _=0;_<b.label.length;_++){let D=F+_;D>=P&&D<=j&&D<g&&(v[D][V]=b.label[_]);}}}else {let[A,C]=R<S?[w,E]:[E,w],[W,U]=R<S?[b.cardinality1,b.cardinality2]:[b.cardinality2,b.cardinality1],P=A.y+A.height,j=C.y-1,B=A.x+Math.floor(A.width/2);for(let V=P;V<=j;V++)V<m&&(v[B][V]=O);let X=C.x+Math.floor(C.width/2);if(B!==X){let V=Math.floor((P+j)/2),_=Math.min(B,X),D=Math.max(B,X);for(let N=_;N<=D;N++)N<g&&V<m&&(v[N][V]=G);for(let N=V+1;N<=j;N++)N<m&&(v[X][N]=O);}let Y=it(W,o);if(P<m)for(let V=0;V<Y.length;V++){let _=B-Math.floor(Y.length/2)+V;_>=0&&_<g&&(v[_][P]=Y[V]);}let H=B!==X?X:B,F=it(U,o);if(j>=0&&j<m)for(let V=0;V<F.length;V++){let _=H-Math.floor(F.length/2)+V;_>=0&&_<g&&(v[_][j]=F[V]);}if(b.label){let V=Math.floor((P+j)/2),_=B+2;if(V>=0)for(let D=0;D<b.label.length;D++){let N=_+D;N>=0&&(_e(v,N+1,V+1),v[N][V]=b.label[D]);}}}}return Ae(v)}function qr(e){let n=e.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(n)?"sequence":/^classdiagram\s*$/.test(n)?"class":/^erdiagram\s*$/.test(n)?"er":"flowchart"}function Et(e,n={}){let r={useAscii:n.useAscii??false,paddingX:n.paddingX??5,paddingY:n.paddingY??5,boxBorderPadding:n.boxBorderPadding??1,graphDirection:"TD"};switch(qr(e)){case "sequence":return sn(e,r);case "class":return ln(e,r);case "er":return hn(e,r);default:{let o=Fe(e);o.direction==="LR"||o.direction==="RL"?r.graphDirection="LR":r.graphDirection="TD";let i=Kt(o,r);return on(i),tn(i),o.direction==="BT"&&Vt(i.canvas),Ae(i.canvas)}}}var Ze=ut(st());function ae(e,n,r){let t=r>=600?.58:r>=500?.55:.52;return e.length*n*t}function at(e,n){return e.length*n*.6}var Z={nodeLabel:19.2,edgeLabel:10,groupHeader:16},Q={nodeLabel:400,edgeLabel:400,groupHeader:600},un=8,Pe={horizontal:24,vertical:24,diamondExtra:24},oe={outerBox:1,innerBox:.75,connector:1.5},de="0.35em",ge={width:7,height:7};function Ee(e,n,r,t){return {x:e-r/2,y:n-t/2}}function Ke(e,n,r,t,o){let i=e.x-n,c=e.y-r;if(Math.abs(i)<.5&&Math.abs(c)<.5)return e;let a=1/(Math.abs(i)/t+Math.abs(c)/o);return {x:n+a*i,y:r+a*c}}function Je(e,n,r,t){let o=e.x-n,i=e.y-r,c=Math.sqrt(o*o+i*i);if(c<.5)return e;let a=t/c;return {x:n+a*o,y:r+a*i}}function De(e,n=true){if(e.length<2)return e;let r=[e[0]];for(let t=1;t<e.length;t++){let o=r[r.length-1],i=e[t],c=Math.abs(i.x-o.x),a=Math.abs(i.y-o.y);if(c<1||a<1){r.push(i);continue}n?r.push({x:o.x,y:i.y}):r.push({x:i.x,y:o.y}),r.push(i);}return Jr(r)}function Jr(e){if(e.length<3)return e;let n=[e[0]];for(let r=1;r<e.length-1;r++){let t=n[n.length-1],o=e[r],i=e[r+1],c=Math.abs(t.x-o.x)<1&&Math.abs(o.x-i.x)<1,a=Math.abs(t.y-o.y)<1&&Math.abs(o.y-i.y)<1;c||a||n.push(o);}return n.push(e[e.length-1]),n}function pn(e,n=true){if(e.length!==4)return e;if(n){let[r,t,o,i]=e,c=Math.abs(r.x-t.x)<1&&Math.abs(r.y-t.y)>=1,a=Math.abs(t.y-o.y)<1&&Math.abs(t.x-o.x)>=1,l=Math.abs(o.x-i.x)<1&&Math.abs(o.y-i.y)>=1;if(c&&a&&l){let h=(r.y+i.y)/2;return [{...r},{x:t.x,y:h},{x:o.x,y:h},{...i}]}}else {let[r,t,o,i]=e,c=Math.abs(r.y-t.y)<1&&Math.abs(r.x-t.x)>=1,a=Math.abs(t.x-o.x)<1&&Math.abs(t.y-o.y)>=1,l=Math.abs(o.y-i.y)<1&&Math.abs(o.x-i.x)>=1;if(c&&a&&l){let h=(r.x+i.x)/2;return [{...r},{x:h,y:t.y},{x:h,y:o.y},{...i}]}}return e}function Ie(e,n,r){if(e.length<2)return e;let t=e.map(o=>({...o}));if(r){let o=t.length-1;if(e.length===2){let i=t[0],c=t[o],a=Math.abs(c.x-i.x);if(Math.abs(c.y-i.y)>=a){let d=c.y>i.y?r.cy-r.hh:r.cy+r.hh;t[o]={x:c.x,y:d};}else {let d=c.x>i.x?r.cx-r.hw:r.cx+r.hw;t[o]={x:d,y:c.y};}}else {let i=t[o-1],c=t[o],a=Math.abs(c.x-i.x),l=Math.abs(c.y-i.y),h=l<1&&a>=1,d=a<1&&l>=1,u=!h&&!d&&l<a,s=!h&&!d&&a<l;if(h){let p=c.x>i.x?r.cx-r.hw:r.cx+r.hw;t[o]={x:p,y:r.cy},t[o-1]={...i,y:r.cy};}else if(d){let p=c.y>i.y?r.cy-r.hh:r.cy+r.hh;t[o]={x:r.cx,y:p},t[o-1]={...i,x:r.cx};}else if(u){let p=c.x>i.x?r.cx-r.hw:r.cx+r.hw;i.y>=r.cy-r.hh&&i.y<=r.cy+r.hh?t[o]={x:p,y:i.y}:(t[o]={x:p,y:r.cy},t[o-1]={...i,y:r.cy});}else if(s){let p=c.y>i.y?r.cy-r.hh:r.cy+r.hh;i.x>=r.cx-r.hw&&i.x<=r.cx+r.hw?t[o]={x:i.x,y:p}:(t[o]={x:r.cx,y:p},t[o-1]={...i,x:r.cx});}}}if(n&&e.length>=3){let o=t[0],i=t[1],c=Math.abs(i.x-o.x),a=Math.abs(i.y-o.y),l=a<1&&c>=1,h=c<1&&a>=1,d=!l&&!h&&a<c,u=!l&&!h&&c<a;if(l){let f=i.x>o.x?n.cx+n.hw:n.cx-n.hw;t[0]={x:f,y:n.cy},t[1]={...t[1],y:n.cy};}else if(h){let f=i.y>o.y?n.cy+n.hh:n.cy-n.hh;t[0]={x:n.cx,y:f},t[1]={...t[1],x:n.cx};}else if(d){let f=i.x>o.x?n.cx+n.hw:n.cx-n.hw;i.y>=n.cy-n.hh&&i.y<=n.cy+n.hh?t[0]={x:f,y:i.y}:(t[0]={x:f,y:n.cy},t[1]={...t[1],y:n.cy});}else if(u){let f=i.y>o.y?n.cy+n.hh:n.cy-n.hh;i.x>=n.cx-n.hw&&i.x<=n.cx+n.hw?t[0]={x:i.x,y:f}:(t[0]={x:n.cx,y:f},t[1]={...t[1],x:n.cx});}}return t}var ct=new Set(["circle","doublecircle","state-start","state-end"]),lt=new Set(["diamond","circle","doublecircle","state-start","state-end"]),Zr={font:"Geist",padding:80,nodeSpacing:40,layerSpacing:50,fontSize:Z.nodeLabel,edgeFontSize:Z.edgeLabel,fontWeight:Q.nodeLabel,nodePaddingX:Pe.horizontal,nodePaddingY:Pe.vertical,groupPaddingX:32,groupPaddingY:32};function Qr(e,n,r){let t=new Ze.default.graphlib.Graph({directed:true,compound:true});t.setGraph({rankdir:mn(e.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:r.groupPaddingX,marginy:r.groupPaddingY}),t.setDefaultEdgeLabel(()=>({}));let o=new Set;o.add(e.id),At(e,o);for(let s of e.nodeIds){let f=n.nodes.get(s);if(f){let p=St(s,f.label,f.shape,r.fontSize,r.fontWeight,r.nodePaddingX,r.nodePaddingY);t.setNode(s,{label:f.label,width:p.width,height:p.height});}}for(let s of e.children)_t(t,s,n,r,e.id);let i=new Set;for(let s=0;s<n.edges.length;s++){let f=n.edges[s];if(o.has(f.source)&&o.has(f.target)){i.add(s);let p={_index:s};f.label&&(p.label=f.label,p.width=ae(f.label,r.edgeFontSize,Q.edgeLabel)+8,p.height=r.edgeFontSize+6,p.labelpos="c"),t.setEdge(f.source,f.target,p);}}Ze.default.layout(t);let c=e.direction==="TD"||e.direction==="TB"||e.direction==="BT",a=new Set;for(let s of e.children)Pt(s,a);let l=[];for(let s of t.nodes()){if(a.has(s))continue;let f=n.nodes.get(s);if(!f)continue;let p=t.node(s);if(!p)continue;let x=Ee(p.x,p.y,p.width,p.height);l.push({id:s,label:f.label,shape:f.shape,x:x.x,y:x.y,width:p.width,height:p.height,inlineStyle:yn(n,s)});}let h=t.edges().map(s=>{let f=t.edge(s),p=n.edges[f._index],x=f.points??[];if(x.length>0){let b=n.nodes.get(s.v)?.shape;if(b==="diamond"){let E=t.node(s.v);x[0]=Ke(x[0],E.x,E.y,E.width/2,E.height/2);}else if(b&&ct.has(b)){let E=t.node(s.v);x[0]=Je(x[0],E.x,E.y,Math.min(E.width,E.height)/2);}let w=n.nodes.get(s.w)?.shape;if(w==="diamond"){let E=t.node(s.w),G=x.length-1;x[G]=Ke(x[G],E.x,E.y,E.width/2,E.height/2);}else if(w&&ct.has(w)){let E=t.node(s.w),G=x.length-1;x[G]=Je(x[G],E.x,E.y,Math.min(E.width,E.height)/2);}}let g=De(x,c),m=n.nodes.get(s.v)?.shape,v=n.nodes.get(s.w)?.shape,$=m&&!lt.has(m)||!m?(()=>{let b=t.node(s.v);return b?{cx:b.x,cy:b.y,hw:b.width/2,hh:b.height/2}:null})():null,M=v&&!lt.has(v)||!v?(()=>{let b=t.node(s.w);return b?{cx:b.x,cy:b.y,hw:b.width/2,hh:b.height/2}:null})():null,L=Ie(g,$,M),y;return p.label&&f.x!=null&&f.y!=null&&(y={x:f.x,y:f.y}),{source:p.source,target:p.target,label:p.label,style:p.style,hasArrowStart:p.hasArrowStart,hasArrowEnd:p.hasArrowEnd,points:L,labelPosition:y}}),d=e.children.map(s=>Lt(t,s)),u=t.graph();return {id:e.id,label:e.label,width:u.width??200,height:u.height??100,nodes:l,edges:h,groups:d,nodeIds:o,internalEdgeIndices:i}}async function gn(e,n={}){let r={...Zr,...n},t=new Map;for(let d of e.subgraphs)d.direction&&d.direction!==e.direction&&t.set(d.id,Qr(d,e,r));let o=new Ze.default.graphlib.Graph({directed:true,compound:true});o.setGraph({rankdir:mn(e.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:r.padding,marginy:r.padding}),o.setDefaultEdgeLabel(()=>({}));let i=new Set;for(let d of e.subgraphs)i.add(d.id),At(d,i);for(let[d,u]of e.nodes)if(!i.has(d)){let s=St(d,u.label,u.shape,r.fontSize,r.fontWeight,r.nodePaddingX,r.nodePaddingY);o.setNode(d,{label:u.label,width:s.width,height:s.height});}for(let d of e.subgraphs)if(t.has(d.id)){let u=t.get(d.id);o.setNode(d.id,{width:u.width,height:u.height});}else _t(o,d,e,r);let c=new Map,a=new Map;for(let d of e.subgraphs)t.has(d.id)||xn(d,c,a);for(let[d,u]of t)for(let s of u.nodeIds)c.set(s,d),a.set(s,d);let l=new Set;for(let d of t.values())for(let u of d.internalEdgeIndices)l.add(u);let h=new Set;for(let d=0;d<e.edges.length;d++){if(l.has(d))continue;let u=e.edges[d],s=a.get(u.source)??u.source,f=c.get(u.target)??u.target,p={_index:d};u.label&&(p.label=u.label,p.width=ae(u.label,r.edgeFontSize,Q.edgeLabel)+8,p.height=r.edgeFontSize+6,p.labelpos="c"),h.has(f)||(p.weight=2,h.add(f)),o.setEdge(s,f,p);}try{Ze.default.layout(o);}catch(d){let u=d instanceof Error?d.message:String(d);throw new Error(`Dagre layout failed: ${u}`)}return eo(o,e,r.padding,t,r.groupPaddingX,r.groupPaddingY)}function mn(e){switch(e){case "LR":return "LR";case "RL":return "RL";case "BT":return "BT";default:return "TB"}}function St(e,n,r,t=Z.nodeLabel,o=Q.nodeLabel,i=Pe.horizontal,c=Pe.vertical){let l=ae(n,t,o)+i*2,h=t+c*2;if(r==="diamond"){let d=Math.max(l,h)+Pe.diamondExtra;l=d,h=d;}if(r==="circle"||r==="doublecircle"){let d=Math.ceil(Math.sqrt(l*l+h*h))+8;l=r==="doublecircle"?d+12:d,h=l;}return r==="stadium"&&(l+=h/2),r==="hexagon"&&(l+=Pe.horizontal),(r==="trapezoid"||r==="trapezoid-alt")&&(l+=Pe.horizontal),r==="asymmetric"&&(l+=12),r==="cylinder"&&(h+=14),(r==="state-start"||r==="state-end")&&(l=28,h=28),l=Math.max(l,60),h=Math.max(h,36),{width:l,height:h}}function _t(e,n,r,t,o){e.setNode(n.id,{label:n.label}),o&&e.setParent(n.id,o);for(let i of n.nodeIds){let c=r.nodes.get(i);if(c){let a=St(i,c.label,c.shape,t.fontSize,t.fontWeight,t.nodePaddingX,t.nodePaddingY);e.setNode(i,{label:c.label,width:a.width,height:a.height}),e.setParent(i,n.id);}}for(let i of n.children)_t(e,i,r,t,n.id);}function xn(e,n,r){for(let c of e.children)xn(c,n,r);let t=[...e.nodeIds,...e.children.map(c=>c.id)];if(t.length===0){n.set(e.id,e.id),r.set(e.id,e.id);return}let o=t[0],i=t[t.length-1];n.set(e.id,n.get(o)??o),r.set(e.id,r.get(i)??i);}function yn(e,n){let r=e.classAssignments.get(n),t=r?e.classDefs.get(r):void 0,o=e.nodeStyles.get(n);if(!(!t&&!o))return {...t,...o}}function At(e,n){for(let r of e.nodeIds)n.add(r);for(let r of e.children)At(r,n);}function eo(e,n,r,t,o=16,i=12){let c=[],a=[],l=new Set;for(let y of n.subgraphs)Pt(y,l);let h=new Set;if(t)for(let y of t.values())for(let b of y.nodeIds)h.add(b);for(let y of e.nodes()){if(l.has(y))continue;let b=n.nodes.get(y);if(!b)continue;let w=e.node(y);if(!w)continue;let E=Ee(w.x,w.y,w.width,w.height);c.push({id:y,label:b.label,shape:b.shape,x:E.x,y:E.y,width:w.width,height:w.height,inlineStyle:yn(n,y),rank:w.rank});}for(let y of n.subgraphs)a.push(Lt(e,y));let d=n.direction==="TD"||n.direction==="TB"||n.direction==="BT",u=e.edges().map(y=>{let b=e.edge(y),w=n.edges[b._index],E=b.points??[];if(E.length>0){let A=n.nodes.get(y.v)?.shape;if(A==="diamond"){let W=e.node(y.v);E[0]=Ke(E[0],W.x,W.y,W.width/2,W.height/2);}else if(A&&ct.has(A)){let W=e.node(y.v);E[0]=Je(E[0],W.x,W.y,Math.min(W.width,W.height)/2);}let C=n.nodes.get(y.w)?.shape;if(C==="diamond"){let W=e.node(y.w),U=E.length-1;E[U]=Ke(E[U],W.x,W.y,W.width/2,W.height/2);}else if(C&&ct.has(C)){let W=e.node(y.w),U=E.length-1;E[U]=Je(E[U],W.x,W.y,Math.min(W.width,W.height)/2);}}let G=De(E,d),O=n.nodes.get(y.v)?.shape,I=n.nodes.get(y.w)?.shape,R=O&&!lt.has(O)||!O?(()=>{let A=e.node(y.v);return A?{cx:A.x,cy:A.y,hw:A.width/2,hh:A.height/2}:null})():null,k=I&&!lt.has(I)||!I?(()=>{let A=e.node(y.w);return A?{cx:A.x,cy:A.y,hw:A.width/2,hh:A.height/2}:null})():null,S=Ie(G,R,k),T;return w.label&&b.x!=null&&b.y!=null&&(T={x:b.x,y:b.y}),{source:w.source,target:w.target,label:w.label,style:w.style,hasArrowStart:w.hasArrowStart,hasArrowEnd:w.hasArrowEnd,points:S,labelPosition:T}});if(t&&t.size>0){let y=new Map;for(let b of c)y.set(b.id,{cx:b.x+b.width/2,cy:b.y+b.height/2});for(let[b,w]of t){let E=e.node(b);if(!E)continue;let G=Ee(E.x,E.y,E.width,E.height);for(let I of w.nodes){let R={...I,x:I.x+G.x,y:I.y+G.y};c.push(R),y.set(R.id,{cx:R.x+R.width/2,cy:R.y+R.height/2});}for(let I of w.edges)u.push({...I,points:I.points.map(R=>({x:R.x+G.x,y:R.y+G.y})),labelPosition:I.labelPosition?{x:I.labelPosition.x+G.x,y:I.labelPosition.y+G.y}:void 0});let O=vn(a,b);O&&w.groups.length>0&&(O.children=w.groups.map(I=>$n(I,G.x,G.y)));}for(let b of u){if(h.has(b.source)&&h.has(b.target))continue;let w=false;if(h.has(b.source)){let E=y.get(b.source);E&&b.points.length>0&&(b.points[0]={x:E.cx,y:E.cy},w=true);}if(h.has(b.target)){let E=y.get(b.target);E&&b.points.length>0&&(b.points[b.points.length-1]={x:E.cx,y:E.cy},w=true);}w&&(b.points=De(b.points,d));}}let s=Z.groupHeader+16;to(a,s);let f=Math.max(0,o-16),p=Math.max(0,i-12);if(f>0||p>0){let y=Ct(a);for(let b of y)b.x-=f,b.width+=f*2,b.height+=p;}let x=Ct(a),g=[...c.map(y=>y.y),...x.map(y=>y.y)],m=g.length>0?Math.min(...g):r,v=e.graph().width??800,$=e.graph().height??600;if(m<r){let y=r-m;for(let b of c)b.y+=y;for(let b of u){for(let w of b.points)w.y+=y;b.labelPosition&&(b.labelPosition.y+=y);}for(let b of x)b.y+=y;$+=y;}let M=Math.max(...c.map(y=>y.y+y.height),...x.map(y=>y.y+y.height),...u.flatMap(y=>y.points.map(b=>b.y)));M+r>$&&($=M+r);for(let y of u)y.points=pn(y.points,d);let L=new Map;for(let y of c)y.rank!=null&&L.set(y.id,y.rank);for(let y of u)y.sourceRank=L.get(y.source),y.targetRank=L.get(y.target);return bn(a,L,c),{width:v,height:$,nodes:c,edges:u,groups:a}}function Lt(e,n){let r=e.node(n.id),t=r?Ee(r.x,r.y,r.width,r.height):{x:0,y:0};return {id:n.id,label:n.label,x:t.x,y:t.y,width:r?.width??0,height:r?.height??0,children:n.children.map(o=>Lt(e,o))}}function bn(e,n,r){for(let t of e){bn(t.children,n,r);let o=1/0;for(let i of t.children)i.rank!=null&&i.rank<o&&(o=i.rank);for(let i of r)i.rank!=null&&i.x>=t.x&&i.x+i.width<=t.x+t.width&&i.y>=t.y&&i.y+i.height<=t.y+t.height&&i.rank<o&&(o=i.rank);t.rank=o===1/0?0:o;}}function to(e,n){for(let r of e)wn(r,n);}function wn(e,n){for(let r of e.children)wn(r,n);if(e.children.length>0){let r=e.y,t=e.y+e.height;for(let o of e.children)r=Math.min(r,o.y),t=Math.max(t,o.y+o.height);e.height=t-r,e.y=r;}if(e.label){let r=n+un;e.y-=r,e.height+=r;}}function Ct(e){let n=[];for(let r of e)n.push(r),n.push(...Ct(r.children));return n}function vn(e,n){for(let r of e){if(r.id===n)return r;let t=vn(r.children,n);if(t)return t}}function $n(e,n,r){return {...e,x:e.x+n,y:e.y+r,children:e.children.map(t=>$n(t,n,r))}}function Pt(e,n){n.add(e.id);for(let r of e.children)Pt(r,n);}var kn={duration:650,stagger:0,groupDelay:110,nodeOverlap:.35,nodeEasing:"ease",edgeEasing:"ease-in-out",nodeAnimation:"fade",edgeAnimation:"draw",reducedMotion:true};function En(e){return e?e===true?{...kn}:{...kn,...e}:null}var no={ease:"0.25 0.1 0.25 1","ease-in":"0.42 0 1 1","ease-out":"0 0 0.58 1","ease-in-out":"0.42 0 0.58 1",linear:"0 0 1 1"};function Mn(e){let n=no[e];if(n)return n;let r=e.match(/cubic-bezier\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)/);return r?`${r[1]} ${r[2]} ${r[3]} ${r[4]}`:"0 0 0.58 1"}function Cn(e,n){let r=new Map,t=new Map,o=new Map,i=n.stagger*.5,c=new Map;for(let h=0;h<e.edges.length;h++){let d=e.edges[h].target;c.has(d)||c.set(d,[]),c.get(d).push(h);}let a=new Map;for(let h of e.nodes){let d=h.rank??0;a.has(d)||a.set(d,[]),a.get(d).push(h);}for(let h of a.values())h.sort((d,u)=>d.x-u.x);let l=[...a.keys()].sort((h,d)=>h-d);for(let h of l){let d=a.get(h);for(let u=0;u<d.length;u++){let s=d[u],f=c.get(s.id);if(!f||f.length===0)r.set(s.id,h*n.stagger+u*i);else {let x=n.duration*n.nodeOverlap,g=0;for(let m of f){let v=t.get(m)??0;g=Math.max(g,v+n.duration);}r.set(s.id,g-x+u*i);}let p=r.get(s.id);for(let x=0;x<e.edges.length;x++)e.edges[x].source===s.id&&t.set(x,p+n.duration);}}return Sn(e.groups,e.nodes,n,r,o),{nodes:r,edges:t,groups:o}}var ro=.6;function Sn(e,n,r,t,o){for(let i of e){Sn(i.children,n,r,t,o);let c=0;for(let a of n){let l=t.get(a.id);l!=null&&a.x>=i.x&&a.x+a.width<=i.x+i.width&&a.y>=i.y&&a.y+a.height<=i.y+i.height&&l>c&&(c=l);}o.set(i.id,c+r.duration*ro+r.groupDelay);}}function _n(e){return `
  /* Animation keyframes */
  @keyframes a-fade { from { opacity: 0 } to { opacity: 1 } }
  @keyframes a-fade-up { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: translateY(0) } }
  @keyframes a-scale { from { opacity: 0; transform: scale(0.85) } to { opacity: 1; transform: scale(1) } }
  @keyframes a-draw { from { stroke-dashoffset: 1 } to { stroke-dashoffset: 0 } }

  /* Animated nodes \u2014 expo-out: fast appear, gentle settle */
  .an { opacity: 0; animation: ${e.nodeAnimation==="fade-up"?"a-fade-up":e.nodeAnimation==="scale"?"a-scale":"a-fade"} ${e.duration}ms ${e.nodeEasing} var(--d) forwards; transform-box: fill-box; transform-origin: center; }

  /* Animated groups \u2014 same easing as nodes */
  .ag { opacity: 0; animation: a-fade ${e.duration}ms ${e.nodeEasing} var(--d) forwards; }

  /* Animated edges \u2014 smooth flow: accelerate from source, decelerate into target */
  .ae { stroke-dasharray: 1; stroke-dashoffset: 1; animation: a-draw ${e.duration}ms ${e.edgeEasing} var(--d) forwards; }

  /* Animated edge labels \u2014 fade with node easing */
  .ael { opacity: 0; animation: a-fade ${e.duration}ms ${e.nodeEasing} var(--d) forwards; }

  /* Arrow hidden until animateMotion begins */
  .aa { opacity: 0; }
  .aa.aa-active { opacity: 1; }
${e.reducedMotion?`
  /* Accessibility: disable animations for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .an, .ag, .ae, .ael, .aa { animation: none !important; opacity: 1 !important; stroke-dashoffset: 0 !important; }
  }`:""}`}function Dn(e,n,r="Geist",t=false,o={},i=null){let c=o.fontSize??Z.nodeLabel,a=o.edgeFontSize??Z.edgeLabel,l=o.fontWeight??Q.nodeLabel,h=o.letterSpacing??-0.384,d=o.cornerRadius??6,u=o.lineWidth??oe.connector,s=o.edgeBendRadius??8,f=o.groupFontSize??Z.groupHeader,p=o.groupFontWeight??Q.groupHeader,x=o.groupFont??"Geist Mono",g=o.groupTextTransform??"uppercase",m=o.groupCornerRadius??3,v=o.groupBorderColor??"#454545",$=i?Cn(e,i):null,M=[];M.push(Se(e.width,e.height,n,t)),M.push(Ce(r,false)),i&&(M.push("<style>"),M.push(_n(i)),M.push("</style>")),M.push("<defs>"),i||M.push(so()),M.push(`  <pattern id="diag-hatch" width="6" height="6" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">
    <rect width="6" height="6" fill="var(--bg)" />
    <line x1="0" y1="0" x2="0" y2="6" stroke="#171717" stroke-width="3" />
  </pattern>`),M.push("</defs>");for(let L of e.groups){let y=$?.groups.get(L.id);i&&y!=null?(M.push(`<g class="ag" style="--d:${y}ms">`),M.push(Rn(L,m,v)),M.push("</g>")):M.push(Tn(L,m,v));}for(let L=0;L<e.edges.length;L++){let y=e.edges[L],b=$?.edges.get(L);i&&b!=null&&i.edgeAnimation==="draw"?M.push(oo(y,L,u,s,b,i)):i&&b!=null&&i.edgeAnimation==="fade"?(M.push(`<g class="an" style="--d:${b}ms">`),M.push(Dt(y,u,s)),M.push("</g>")):M.push(Dt(y,u,s));}for(let L of e.groups){let y=$?.groups.get(L.id);i&&y!=null?(M.push(`<g class="an" style="--d:${y}ms">`),M.push(Nn(L,r,f,p,x,g)),M.push("</g>")):M.push(In(L,r,f,p,x,g));}for(let L=0;L<e.edges.length;L++){let y=e.edges[L];if(y.label){let b=$?.edges.get(L);i&&b!=null?(M.push(`<g class="ael" style="--d:${b}ms">`),M.push(An(y,r,a)),M.push("</g>")):M.push(An(y,r,a));}}if(i)for(let L of e.nodes){let y=$?.nodes.get(L.id)??0;M.push(`<g class="an" style="--d:${y}ms">`),M.push(Ln(L,d)),M.push(Pn(L,r,c,l,h)),M.push("</g>");}else {for(let L of e.nodes)M.push(Ln(L,d));for(let L of e.nodes)M.push(Pn(L,r,c,l,h));}return M.push("</svg>"),M.join(`
`)}function oo(e,n,r,t,o,i){if(e.points.length<2)return "";let c=e.style==="thick"?r*2:r;if(e.style==="dotted")return `<g class="an" style="--d:${o}ms">${Dt(e,r,t)}</g>`;let a=e.points.map(s=>({...s}));if(e.hasArrowEnd&&a.length>=2){let s=ge.width+2,f=a[a.length-1],p=a[a.length-2],x=f.x-p.x,g=f.y-p.y,m=Math.sqrt(x*x+g*g);m>s&&(f.x-=x/m*s,f.y-=g/m*s);}let l=`e${n}`,h;t>0&&a.length>2?h=Gn(a,t):h=io(a);let d=[];d.push(`<path id="${l}" d="${h}" pathLength="1" class="ae" style="--d:${o}ms" fill="none" stroke="var(--_line)" stroke-width="${c}" />`);let u=Mn(i.edgeEasing);if(e.hasArrowEnd){let s=ge.width,f=ge.height/2,p=(i.duration/1e3).toFixed(3),x=(o/1e3).toFixed(3);d.push(`<polygon points="0 ${-f}, ${s} 0, 0 ${f}" fill="var(--_arrow)" opacity="0">
  <animateMotion dur="${p}s" begin="${x}s" fill="freeze" rotate="auto" keyPoints="0;1" keyTimes="0;1" calcMode="spline" keySplines="${u}">
    <mpath href="#${l}" />
  </animateMotion>
  <set attributeName="opacity" to="1" begin="${x}s" fill="freeze" />
</polygon>`);}if(e.hasArrowStart){let s=ge.width,f=ge.height/2,p=(i.duration/1e3).toFixed(3),x=(o/1e3).toFixed(3);d.push(`<polygon points="${s} ${-f}, 0 0, ${s} ${f}" fill="var(--_arrow)" opacity="0">
  <animateMotion dur="${p}s" begin="${x}s" fill="freeze" rotate="auto" keyPoints="1;0" keyTimes="0;1" calcMode="spline" keySplines="${u}">
    <mpath href="#${l}" />
  </animateMotion>
  <set attributeName="opacity" to="1" begin="${x}s" fill="freeze" />
</polygon>`);}return d.join(`
`)}function io(e){return e.length===0?"":"M"+e.map(n=>`${n.x},${n.y}`).join(" L")}function so(){let e=ge.width,n=ge.height;return `  <marker id="arrowhead" markerWidth="${e}" markerHeight="${n}" refX="0" refY="${n/2}" orient="auto" markerUnits="userSpaceOnUse" overflow="visible">
    <polygon points="0 0, ${e} ${n/2}, 0 ${n}" fill="var(--_arrow)" />
  </marker>
  <marker id="arrowhead-start" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto-start-reverse" markerUnits="userSpaceOnUse" overflow="visible">
    <polygon points="${e} 0, 0 ${n/2}, ${e} ${n}" fill="var(--_arrow)" />
  </marker>`}function Tn(e,n=0,r="var(--_node-stroke)"){let t=[];t.push(Rn(e,n,r));for(let o of e.children)t.push(Tn(o,n,r));return t.join(`
`)}function Rn(e,n,r){return `<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="${n}" ry="${n}" fill="url(#diag-hatch)" stroke="${r}" stroke-width="${oe.outerBox}" />`}function In(e,n,r,t,o,i){let c=[];c.push(Nn(e,n,r,t,o,i));for(let a of e.children)c.push(In(a,n,r,t,o,i));return c.join(`
`)}function Nn(e,n,r,t,o,i){let c=r+32,a=i?`text-transform:${i};`:"",l=Ne(e.label),h=ae(l,r,t)*(i==="uppercase"?1.15:1),d=8,u=4,s=e.x+16-d,f=e.y+c/2-r/2-u,p=h+d*2,x=r+u*2;return `<rect x="${s}" y="${f}" width="${p}" height="${x}" fill="var(--bg)" rx="2" ry="2" />
<text x="${e.x+16}" y="${e.y+c/2}" dy="${de}" style="font-family:'${o}',system-ui,sans-serif;font-size:${r}px;font-weight:${t};${a}" fill="rgba(255,255,255,0.92)">${l}</text>`}function Dt(e,n,r){if(e.points.length<2)return "";let t=e.style==="dotted"?' stroke-dasharray="4 4"':"",o=e.style==="thick"?n*2:n,i="";e.hasArrowEnd&&(i+=' marker-end="url(#arrowhead)"'),e.hasArrowStart&&(i+=' marker-start="url(#arrowhead-start)"');let c=e.points.map(l=>({...l}));if(e.hasArrowEnd&&c.length>=2){let l=ge.width+2,h=c[c.length-1],d=c[c.length-2],u=h.x-d.x,s=h.y-d.y,f=Math.sqrt(u*u+s*s);f>l&&(h.x-=u/f*l,h.y-=s/f*l);}return r>0&&c.length>2?`<path d="${Gn(c,r)}" fill="none" stroke="var(--_line)" stroke-width="${o}"${t}${i} />`:`<polyline points="${ao(c)}" fill="none" stroke="var(--_line)" stroke-width="${o}"${t}${i} />`}function ao(e){return e.map(n=>`${n.x},${n.y}`).join(" ")}function Gn(e,n){if(e.length<2)return "";if(e.length===2)return `M${e[0].x},${e[0].y} L${e[1].x},${e[1].y}`;let r=[`M${e[0].x},${e[0].y}`];for(let o=1;o<e.length-1;o++){let i=e[o-1],c=e[o],a=e[o+1],l=dt(i,c),h=dt(c,a),d=Math.min(n,l/2,h/2),u=c.x+(i.x-c.x)*(d/l),s=c.y+(i.y-c.y)*(d/l),f=c.x+(a.x-c.x)*(d/h),p=c.y+(a.y-c.y)*(d/h);r.push(`L${u},${s}`),r.push(`Q${c.x},${c.y} ${f},${p}`);}let t=e[e.length-1];return r.push(`L${t.x},${t.y}`),r.join(" ")}function An(e,n,r){let t=e.labelPosition??co(e.points),o=e.label,i=ae(o,r,Q.edgeLabel),c=8,a=i+c*2,l=r+c*2;return `<rect x="${t.x-a/2}" y="${t.y-l/2}" width="${a}" height="${l}" rx="4" ry="4" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${t.x}" y="${t.y}" text-anchor="middle" dy="${de}" font-size="${r}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Ne(o)}</text>`}function co(e){if(e.length===0)return {x:0,y:0};if(e.length===1)return e[0];let n=0;for(let t=1;t<e.length;t++)n+=dt(e[t-1],e[t]);let r=n/2;for(let t=1;t<e.length;t++){let o=dt(e[t-1],e[t]);if(r<=o){let i=r/o;return {x:e[t-1].x+i*(e[t].x-e[t-1].x),y:e[t-1].y+i*(e[t].y-e[t-1].y)}}r-=o;}return e[e.length-1]}function dt(e,n){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}function Ln(e,n){let{x:r,y:t,width:o,height:i,shape:c,inlineStyle:a}=e,l=Ne(a?.fill??"var(--_node-fill)"),h=Ne(a?.stroke??"var(--_node-stroke)"),d=Ne(a?.["stroke-width"]??String(oe.innerBox));switch(c){case "diamond":return po(r,t,o,i,l,h,d);case "rounded":return ho(r,t,o,i,l,h,d);case "stadium":return fo(r,t,o,i,l,h,d);case "circle":return uo(r,t,o,i,l,h,d);case "subroutine":return go(r,t,o,i,l,h,d);case "doublecircle":return mo(r,t,o,i,l,h,d);case "hexagon":return xo(r,t,o,i,l,h,d);case "cylinder":return yo(r,t,o,i,l,h,d);case "asymmetric":return bo(r,t,o,i,l,h,d);case "trapezoid":return wo(r,t,o,i,l,h,d);case "trapezoid-alt":return vo(r,t,o,i,l,h,d);case "state-start":return $o(r,t,o,i);case "state-end":return ko(r,t,o,i);default:return lo(r,t,o,i,l,h,d,n)}}function lo(e,n,r,t,o,i,c,a=0){return `<rect x="${e}" y="${n}" width="${r}" height="${t}" rx="${a}" ry="${a}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function ho(e,n,r,t,o,i,c){return `<rect x="${e}" y="${n}" width="${r}" height="${t}" rx="6" ry="6" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function fo(e,n,r,t,o,i,c){let a=t/2;return `<rect x="${e}" y="${n}" width="${r}" height="${t}" rx="${a}" ry="${a}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function uo(e,n,r,t,o,i,c){let a=e+r/2,l=n+t/2,h=Math.min(r,t)/2;return `<circle cx="${a}" cy="${l}" r="${h}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function po(e,n,r,t,o,i,c){let a=e+r/2,l=n+t/2,h=r/2,d=t/2;return `<polygon points="${`${a},${l-d} ${a+h},${l} ${a},${l+d} ${a-h},${l}`}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function go(e,n,r,t,o,i,c){return `<rect x="${e}" y="${n}" width="${r}" height="${t}" rx="0" ry="0" fill="${o}" stroke="${i}" stroke-width="${c}" />
<line x1="${e+8}" y1="${n}" x2="${e+8}" y2="${n+t}" stroke="${i}" stroke-width="${c}" />
<line x1="${e+r-8}" y1="${n}" x2="${e+r-8}" y2="${n+t}" stroke="${i}" stroke-width="${c}" />`}function mo(e,n,r,t,o,i,c){let a=e+r/2,l=n+t/2,h=Math.min(r,t)/2,d=h-5;return `<circle cx="${a}" cy="${l}" r="${h}" fill="${o}" stroke="${i}" stroke-width="${c}" />
<circle cx="${a}" cy="${l}" r="${d}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function xo(e,n,r,t,o,i,c){let a=t/4;return `<polygon points="${`${e+a},${n} ${e+r-a},${n} ${e+r},${n+t/2} ${e+r-a},${n+t} ${e+a},${n+t} ${e},${n+t/2}`}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function yo(e,n,r,t,o,i,c){let l=e+r/2,h=n+7,d=t-14;return `<rect x="${e}" y="${h}" width="${r}" height="${d}" fill="${o}" stroke="none" />
<line x1="${e}" y1="${h}" x2="${e}" y2="${h+d}" stroke="${i}" stroke-width="${c}" />
<line x1="${e+r}" y1="${h}" x2="${e+r}" y2="${h+d}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${n+t-7}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${h}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function bo(e,n,r,t,o,i,c){return `<polygon points="${`${e+12},${n} ${e+r},${n} ${e+r},${n+t} ${e+12},${n+t} ${e},${n+t/2}`}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function wo(e,n,r,t,o,i,c){let a=r*.15;return `<polygon points="${`${e+a},${n} ${e+r-a},${n} ${e+r},${n+t} ${e},${n+t}`}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function vo(e,n,r,t,o,i,c){let a=r*.15;return `<polygon points="${`${e},${n} ${e+r},${n} ${e+r-a},${n+t} ${e+a},${n+t}`}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function $o(e,n,r,t){let o=e+r/2,i=n+t/2,c=Math.min(r,t)/2-2;return `<circle cx="${o}" cy="${i}" r="${c}" fill="var(--_text)" stroke="none" />`}function ko(e,n,r,t){let o=e+r/2,i=n+t/2,c=Math.min(r,t)/2-2,a=c-4;return `<circle cx="${o}" cy="${i}" r="${c}" fill="none" stroke="var(--_text)" stroke-width="${oe.innerBox*2}" />
<circle cx="${o}" cy="${i}" r="${a}" fill="var(--_text)" stroke="none" />`}function Pn(e,n,r,t,o){if((e.shape==="state-start"||e.shape==="state-end")&&!e.label)return "";let i=e.x+e.width/2,c=e.y+e.height/2,a=Ne(e.inlineStyle?.color??"var(--_text)"),l=o?` letter-spacing="${o}"`:"";return `<text x="${i}" y="${c}" text-anchor="middle" dy="${de}" font-size="${r}" font-weight="${t}"${l} fill="${a}">${Ne(e.label)}</text>`}function Ne(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var te={padding:30,actorGap:140,actorHeight:40,actorPadX:16,headerGap:20,messageRowHeight:40,selfMessageHeight:30,activationWidth:10,blockPadX:10,blockPadTop:40,blockPadBottom:8,blockHeaderExtra:28,dividerExtra:24,noteWidth:120,notePadding:8,noteGap:10};function On(e,n={}){if(e.actors.length===0)return {width:0,height:0,actors:[],lifelines:[],messages:[],activations:[],blocks:[],notes:[]};let r=e.actors.map(y=>{let b=ae(y.label,Z.nodeLabel,Q.nodeLabel);return Math.max(b+te.actorPadX*2,80)}),t=[],o=te.padding+r[0]/2;for(let y=0;y<e.actors.length;y++){if(y>0){let b=Math.max(te.actorGap,(r[y-1]+r[y])/2+40);o+=b;}t.push(o);}let i=new Map;for(let y=0;y<e.actors.length;y++)i.set(e.actors[y].id,y);let c=te.padding,a=e.actors.map((y,b)=>({id:y.id,label:y.label,type:y.type,x:t[b],y:c,width:r[b],height:te.actorHeight})),l=c+te.actorHeight+te.headerGap,h=[],d=new Map;for(let y of e.blocks){let b=d.get(y.startIndex)??0;d.set(y.startIndex,Math.max(b,te.blockHeaderExtra));for(let w of y.dividers){let E=d.get(w.index)??0;d.set(w.index,Math.max(E,te.dividerExtra));}}let u=new Map,s=[];for(let y=0;y<e.messages.length;y++){let b=e.messages[y],w=i.get(b.from)??0,E=i.get(b.to)??0,G=b.from===b.to,O=d.get(y)??0;O>0&&(l+=O);let I=t[w],R=t[E];if(h.push({from:b.from,to:b.to,label:b.label,lineStyle:b.lineStyle,arrowHead:b.arrowHead,x1:I,x2:R,y:l,isSelf:G}),b.activate&&(u.has(b.to)||u.set(b.to,[]),u.get(b.to).push(l)),b.deactivate){let k=u.get(b.from);if(k&&k.length>0){let S=k.pop(),T=i.get(b.from)??0;s.push({actorId:b.from,x:t[T]-te.activationWidth/2,topY:S,bottomY:l,width:te.activationWidth});}}l+=G?te.selfMessageHeight+te.messageRowHeight:te.messageRowHeight;}for(let[y,b]of u)for(let w of b){let E=i.get(y)??0;s.push({actorId:y,x:t[E]-te.activationWidth/2,topY:w,bottomY:l-te.messageRowHeight/2,width:te.activationWidth});}let f=e.blocks.map(y=>{let b=h[y.startIndex],w=h[y.endIndex],E=(b?.y??l)-te.blockPadTop,G=(w?.y??l)+te.blockPadBottom+12,O=new Set;for(let A=y.startIndex;A<=y.endIndex;A++){let C=e.messages[A];C&&(O.add(i.get(C.from)??0),O.add(i.get(C.to)??0));}if(O.size===0)for(let A=0;A<e.actors.length;A++)O.add(A);let I=Math.min(...O),R=Math.max(...O),k=t[I]-r[I]/2-te.blockPadX,S=t[R]+r[R]/2+te.blockPadX,T=y.dividers.map(A=>{let C=h[A.index],W=C?.y??l,U=28;if(A.label&&C?.label){let P=`[${A.label}]`,j=ae(P,Z.edgeLabel,Q.edgeLabel),B=k+8,X=B+j,Y=ae(C.label,Z.edgeLabel,Q.edgeLabel),H=C.isSelf?C.x1+36:(C.x1+C.x2)/2-Y/2,F=H+Y;X>H&&B<F&&(U=36);}return {y:W-U,label:A.label}});return {type:y.type,label:y.label,x:k,y:E,width:S-k,height:G-E,dividers:T}}),p=e.notes.map(y=>{let b=Math.max(te.noteWidth,ae(y.text,Z.edgeLabel,Q.edgeLabel)+te.notePadding*2),w=Z.edgeLabel+te.notePadding*2,G=(h[y.afterIndex]?.y??c+te.actorHeight)+4,O=i.get(y.actorIds[0]??"")??0,I;if(y.position==="left")I=t[O]-r[O]/2-b-te.noteGap;else if(y.position==="right")I=t[O]+r[O]/2+te.noteGap;else if(y.actorIds.length>1){let R=i.get(y.actorIds[y.actorIds.length-1]??"")??O;I=(t[O]+t[R])/2-b/2;}else I=t[O]-b/2;return {text:y.text,x:I,y:G,width:b,height:w}}),x=l+te.padding,g=te.padding,m=0;for(let y of a)g=Math.min(g,y.x-y.width/2),m=Math.max(m,y.x+y.width/2);for(let y of f)g=Math.min(g,y.x),m=Math.max(m,y.x+y.width);for(let y of p)g=Math.min(g,y.x),m=Math.max(m,y.x+y.width);let v=g<te.padding?te.padding-g:0;if(v>0){for(let y of a)y.x+=v;for(let y of h)y.x1+=v,y.x2+=v;for(let y of s)y.x+=v;for(let y of f)y.x+=v;for(let y of p)y.x+=v;for(let y=0;y<t.length;y++)t[y]+=v;}let $=e.actors.map((y,b)=>({actorId:y.id,x:t[b],topY:c+te.actorHeight,bottomY:x-te.padding})),M=m+v+te.padding,L=x;return {width:Math.max(M,200),height:Math.max(L,100),actors:a,lifelines:$,messages:h,activations:s,blocks:f,notes:p}}function Wn(e,n,r="Inter",t=false){let o=[];o.push(Se(e.width,e.height,n,t)),o.push(Ce(r,false)),o.push("<defs>"),o.push(Eo()),o.push("</defs>");for(let i of e.blocks)o.push(Ao(i));for(let i of e.lifelines)o.push(Co(i));for(let i of e.activations)o.push(So(i));for(let i of e.messages)o.push(_o(i));for(let i of e.notes)o.push(Lo(i));for(let i of e.actors)o.push(Mo(i));return o.push("</svg>"),o.join(`
`)}function Eo(){let e=ge.width,n=ge.height;return `  <marker id="seq-arrow" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto-start-reverse">
    <polygon points="0 0, ${e} ${n/2}, 0 ${n}" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto-start-reverse">
    <polyline points="0 0, ${e} ${n/2}, 0 ${n}" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>`}function Mo(e){let{x:n,y:r,width:t,height:o,label:i,type:c}=e;if(c==="actor"){let l=o/24*.9,h=n-12*l,d=r+(o-24*l)/2,u=oe.outerBox/l,s="var(--_line)";return `<g transform="translate(${h},${d}) scale(${l})">
  <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" fill="none" stroke="${s}" stroke-width="${u}" />
  <path d="M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z" fill="none" stroke="${s}" stroke-width="${u}" />
  <path d="M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563" fill="none" stroke="${s}" stroke-width="${u}" />
</g>
<text x="${n}" y="${r+o+14}" text-anchor="middle" font-size="${Z.nodeLabel}" font-weight="${Q.nodeLabel}" fill="var(--_text)">${Ge(i)}</text>`}return `<rect x="${n-t/2}" y="${r}" width="${t}" height="${o}" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />
<text x="${n}" y="${r+o/2}" text-anchor="middle" dy="${de}" font-size="${Z.nodeLabel}" font-weight="${Q.nodeLabel}" fill="var(--_text)">${Ge(i)}</text>`}function Co(e){return `<line x1="${e.x}" y1="${e.topY}" x2="${e.x}" y2="${e.bottomY}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`}function So(e){return `<rect x="${e.x}" y="${e.topY}" width="${e.width}" height="${e.bottomY-e.topY}" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${oe.innerBox}" />`}function _o(e){let n=[],r=e.lineStyle==="dashed"?' stroke-dasharray="6 4"':"",t=e.arrowHead==="filled"?"seq-arrow":"seq-arrow-open";if(e.isSelf)n.push(`<polyline points="${e.x1},${e.y} ${e.x1+30},${e.y} ${e.x1+30},${e.y+20} ${e.x2},${e.y+20}" fill="none" stroke="var(--_line)" stroke-width="${oe.connector}"${r} marker-end="url(#${t})" />`),n.push(`<text x="${e.x1+30+6}" y="${e.y+20/2}" dy="${de}" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Ge(e.label)}</text>`);else {n.push(`<line x1="${e.x1}" y1="${e.y}" x2="${e.x2}" y2="${e.y}" stroke="var(--_line)" stroke-width="${oe.connector}"${r} marker-end="url(#${t})" />`);let o=(e.x1+e.x2)/2;n.push(`<text x="${o}" y="${e.y-6}" text-anchor="middle" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Ge(e.label)}</text>`);}return n.join(`
`)}function Ao(e){let n=[];n.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`);let r=`${e.type}${e.label?` [${e.label}]`:""}`,t=ae(r,Z.edgeLabel,Q.groupHeader)+16,o=18;n.push(`<rect x="${e.x}" y="${e.y}" width="${t}" height="${o}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`),n.push(`<text x="${e.x+6}" y="${e.y+o/2}" dy="${de}" font-size="${Z.edgeLabel}" font-weight="${Q.groupHeader}" fill="var(--_text-sec)">${Ge(r)}</text>`);for(let i of e.dividers)n.push(`<line x1="${e.x}" y1="${i.y}" x2="${e.x+e.width}" y2="${i.y}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`),i.label&&n.push(`<text x="${e.x+8}" y="${i.y+14}" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">[${Ge(i.label)}]</text>`);return n.join(`
`)}function Lo(e){return `<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${oe.innerBox}" />
<polygon points="${e.x+e.width-6},${e.y} ${e.x+e.width},${e.y+6} ${e.x+e.width-6},${e.y+6}" fill="var(--_inner-stroke)" />
<text x="${e.x+e.width/2}" y="${e.y+e.height/2}" text-anchor="middle" dy="${de}" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Ge(e.text)}</text>`}function Ge(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Tt=ut(st());var le={padding:40,boxPadX:8,headerBaseHeight:32,annotationHeight:16,memberRowHeight:20,sectionPadY:8,emptySectionHeight:8,minWidth:120,memberFontSize:11,nodeSpacing:40,layerSpacing:60};async function Yn(e,n={}){if(e.classes.length===0)return {width:0,height:0,classes:[],relationships:[]};let r=new Map;for(let a of e.classes){let l=a.annotation?le.headerBaseHeight+le.annotationHeight:le.headerBaseHeight,h=a.attributes.length>0?a.attributes.length*le.memberRowHeight+le.sectionPadY:le.emptySectionHeight,d=a.methods.length>0?a.methods.length*le.memberRowHeight+le.sectionPadY:le.emptySectionHeight,u=ae(a.label,Z.nodeLabel,Q.nodeLabel),s=Hn(a.attributes),f=Hn(a.methods),p=Math.max(le.minWidth,u+le.boxPadX*2,s+le.boxPadX*2,f+le.boxPadX*2),x=l+h+d;r.set(a.id,{width:p,height:x,headerHeight:l,attrHeight:h,methodHeight:d});}let t=new Tt.default.graphlib.Graph({directed:true});t.setGraph({rankdir:"TB",acyclicer:"greedy",nodesep:le.nodeSpacing,ranksep:le.layerSpacing,marginx:le.padding,marginy:le.padding}),t.setDefaultEdgeLabel(()=>({}));for(let a of e.classes){let l=r.get(a.id);t.setNode(a.id,{width:l.width,height:l.height});}for(let a=0;a<e.relationships.length;a++){let l=e.relationships[a],h={_index:a};l.label&&(h.label=l.label,h.width=ae(l.label,Z.edgeLabel,Q.edgeLabel)+8,h.height=Z.edgeLabel+6,h.labelpos="c"),t.setEdge(l.from,l.to,h);}try{Tt.default.layout(t);}catch(a){let l=a instanceof Error?a.message:String(a);throw new Error(`Dagre layout failed (class diagram): ${l}`)}let o=new Map;for(let a of e.classes)o.set(a.id,a);let i=e.classes.map(a=>{let l=t.node(a.id),h=r.get(a.id),d=Ee(l.x,l.y,l.width,l.height);return {id:a.id,label:a.label,annotation:a.annotation,attributes:a.attributes,methods:a.methods,x:d.x,y:d.y,width:l.width??h.width,height:l.height??h.height,headerHeight:h.headerHeight,attrHeight:h.attrHeight,methodHeight:h.methodHeight}}),c=t.edges().map(a=>{let l=t.edge(a),h=e.relationships[l._index],d=l.points??[],u=De(d,true),s=t.node(a.v),f=t.node(a.w),p=Ie(u,s?{cx:s.x,cy:s.y,hw:s.width/2,hh:s.height/2}:null,f?{cx:f.x,cy:f.y,hw:f.width/2,hh:f.height/2}:null),x;return h.label&&l.x!=null&&l.y!=null&&(x={x:l.x,y:l.y}),{from:h.from,to:h.to,type:h.type,markerAt:h.markerAt,label:h.label,fromCardinality:h.fromCardinality,toCardinality:h.toCardinality,points:p,labelPosition:x}});return {width:t.graph().width??600,height:t.graph().height??400,classes:i,relationships:c}}function Hn(e){if(e.length===0)return 0;let n=0;for(let r of e){let t=Po(r),o=at(t,le.memberFontSize);o>n&&(n=o);}return n}function Po(e){let n=e.visibility?`${e.visibility} `:"",r=e.type?`: ${e.type}`:"";return `${n}${e.name}${r}`}var ht={memberSize:11,memberWeight:400,annotationSize:10,annotationWeight:500};function jn(e,n,r="Inter",t=false){let o=[];o.push(Se(e.width,e.height,n,t)),o.push(Ce(r,true)),o.push("<defs>"),o.push(Do()),o.push("</defs>");for(let i of e.relationships)o.push(Ro(i));for(let i of e.classes)o.push(To(i));for(let i of e.relationships)o.push(Go(i));return o.push("</svg>"),o.join(`
`)}function Do(){return `  <marker id="cls-inherit" markerWidth="12" markerHeight="10" refX="12" refY="5" orient="auto-start-reverse">
    <polygon points="0 0, 12 5, 0 10" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-composition" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--_arrow)" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
  <marker id="cls-aggregation" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto-start-reverse">
    <polyline points="0 0, 8 3, 0 6" fill="none" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>`}function To(e){let{x:n,y:r,width:t,height:o,headerHeight:i,attrHeight:c,methodHeight:a}=e,l=[];l.push(`<rect x="${n}" y="${r}" width="${t}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`),l.push(`<rect x="${n}" y="${r}" width="${t}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`);let h=r+i/2;if(e.annotation){let f=r+12;l.push(`<text x="${n+t/2}" y="${f}" text-anchor="middle" dy="${de}" font-size="${ht.annotationSize}" font-weight="${ht.annotationWeight}" font-style="italic" fill="var(--_text-muted)">&lt;&lt;${Te(e.annotation)}&gt;&gt;</text>`),h=r+i/2+6;}l.push(`<text x="${n+t/2}" y="${h}" text-anchor="middle" dy="${de}" font-size="${Z.nodeLabel}" font-weight="700" fill="var(--_text)">${Te(e.label)}</text>`);let d=r+i;l.push(`<line x1="${n}" y1="${d}" x2="${n+t}" y2="${d}" stroke="var(--_node-stroke)" stroke-width="${oe.innerBox}" />`);let u=20;for(let f=0;f<e.attributes.length;f++){let p=e.attributes[f],x=d+4+f*u+u/2;l.push(Xn(p,n+le.boxPadX,x));}let s=d+c;l.push(`<line x1="${n}" y1="${s}" x2="${n+t}" y2="${s}" stroke="var(--_node-stroke)" stroke-width="${oe.innerBox}" />`);for(let f=0;f<e.methods.length;f++){let p=e.methods[f],x=s+4+f*u+u/2;l.push(Xn(p,n+le.boxPadX,x));}return l.join(`
`)}function Xn(e,n,r){let t=e.isAbstract?' font-style="italic"':"",o=e.isStatic?' text-decoration="underline"':"",i=[];return e.visibility&&i.push(`<tspan fill="var(--_text-faint)">${Te(e.visibility)} </tspan>`),i.push(`<tspan fill="var(--_text-sec)">${Te(e.name)}</tspan>`),e.type&&(i.push('<tspan fill="var(--_text-faint)">: </tspan>'),i.push(`<tspan fill="var(--_text-muted)">${Te(e.type)}</tspan>`)),`<text x="${n}" y="${r}" class="mono" dy="${de}" font-size="${ht.memberSize}" font-weight="${ht.memberWeight}"${t}${o}>${i.join("")}</text>`}function Ro(e){if(e.points.length<2)return "";let n=e.points.map(i=>`${i.x},${i.y}`).join(" "),t=e.type==="dependency"||e.type==="realization"?' stroke-dasharray="6 4"':"",o=Io(e.type,e.markerAt);return `<polyline points="${n}" fill="none" stroke="var(--_line)" stroke-width="${oe.connector}"${t}${o} />`}function Io(e,n){let r=No(e);return r?n==="from"?` marker-start="url(#${r})"`:` marker-end="url(#${r})"`:""}function No(e){switch(e){case "inheritance":case "realization":return "cls-inherit";case "composition":return "cls-composition";case "aggregation":return "cls-aggregation";case "association":case "dependency":return "cls-arrow";default:return null}}function Go(e){if(!e.label&&!e.fromCardinality&&!e.toCardinality||e.points.length<2)return "";let n=[];if(e.label){let r=e.labelPosition??Oo(e.points);n.push(`<text x="${r.x}" y="${r.y-8}" text-anchor="middle" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Te(e.label)}</text>`);}if(e.fromCardinality){let r=e.points[0],t=e.points[1],o=Bn(r,t);n.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Te(e.fromCardinality)}</text>`);}if(e.toCardinality){let r=e.points[e.points.length-1],t=e.points[e.points.length-2],o=Bn(r,t);n.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${Te(e.toCardinality)}</text>`);}return n.join(`
`)}function Oo(e){if(e.length===0)return {x:0,y:0};let n=Math.floor(e.length/2);return e[n]}function Bn(e,n){let r=n.x-e.x,t=n.y-e.y;return Math.abs(r)>Math.abs(t)?{x:r>0?14:-14,y:-10}:{x:-14,y:t>0?14:-14}}function Te(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Rt=ut(st());var me={padding:40,boxPadX:12,headerHeight:32,rowHeight:22,minWidth:140,attrFontSize:11,nodeSpacing:50,layerSpacing:70};async function Fn(e,n={}){if(e.entities.length===0)return {width:0,height:0,entities:[],relationships:[]};let r=new Map;for(let a of e.entities){let l=ae(a.label,Z.nodeLabel,Q.nodeLabel),h=0;for(let s of a.attributes){let f=`${s.type}  ${s.name}${s.keys.length>0?"  "+s.keys.join(","):""}`,p=at(f,me.attrFontSize);p>h&&(h=p);}let d=Math.max(me.minWidth,l+me.boxPadX*2,h+me.boxPadX*2),u=me.headerHeight+Math.max(a.attributes.length,1)*me.rowHeight;r.set(a.id,{width:d,height:u});}let t=new Rt.default.graphlib.Graph({directed:true});t.setGraph({rankdir:"LR",acyclicer:"greedy",nodesep:me.nodeSpacing,ranksep:me.layerSpacing,marginx:me.padding,marginy:me.padding}),t.setDefaultEdgeLabel(()=>({}));for(let a of e.entities){let l=r.get(a.id);t.setNode(a.id,{width:l.width,height:l.height});}for(let a=0;a<e.relationships.length;a++){let l=e.relationships[a];t.setEdge(l.entity1,l.entity2,{_index:a,label:l.label,width:ae(l.label,Z.edgeLabel,Q.edgeLabel)+8,height:Z.edgeLabel+6,labelpos:"c"});}try{Rt.default.layout(t);}catch(a){let l=a instanceof Error?a.message:String(a);throw new Error(`Dagre layout failed (ER diagram): ${l}`)}let o=new Map;for(let a of e.entities)o.set(a.id,a);let i=e.entities.map(a=>{let l=t.node(a.id),h=Ee(l.x,l.y,l.width,l.height);return {id:a.id,label:a.label,attributes:a.attributes,x:h.x,y:h.y,width:l.width??r.get(a.id).width,height:l.height??r.get(a.id).height,headerHeight:me.headerHeight,rowHeight:me.rowHeight}}),c=t.edges().map(a=>{let l=t.edge(a),h=e.relationships[l._index],d=l.points??[],u=De(d,false),s=t.node(a.v),f=t.node(a.w),p=Ie(u,s?{cx:s.x,cy:s.y,hw:s.width/2,hh:s.height/2}:null,f?{cx:f.x,cy:f.y,hw:f.width/2,hh:f.height/2}:null);return {entity1:h.entity1,entity2:h.entity2,cardinality1:h.cardinality1,cardinality2:h.cardinality2,label:h.label,identifying:h.identifying,points:p}});return {width:t.graph().width??600,height:t.graph().height??400,entities:i,relationships:c}}var Me={attrSize:11,attrWeight:400,keySize:9,keyWeight:600};function Vn(e,n,r="Inter",t=false){let o=[];o.push(Se(e.width,e.height,n,t)),o.push(Ce(r,true)),o.push("<defs>"),o.push("</defs>");for(let i of e.relationships)o.push(Yo(i));for(let i of e.entities)o.push(Wo(i));for(let i of e.relationships)o.push(Bo(i));for(let i of e.relationships)o.push(Xo(i));return o.push("</svg>"),o.join(`
`)}function Wo(e){let{x:n,y:r,width:t,height:o,headerHeight:i,rowHeight:c,label:a,attributes:l}=e,h=[];h.push(`<rect x="${n}" y="${r}" width="${t}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`),h.push(`<rect x="${n}" y="${r}" width="${t}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${oe.outerBox}" />`),h.push(`<text x="${n+t/2}" y="${r+i/2}" text-anchor="middle" dy="${de}" font-size="${Z.nodeLabel}" font-weight="700" fill="var(--_text)">${ft(a)}</text>`);let d=r+i;h.push(`<line x1="${n}" y1="${d}" x2="${n+t}" y2="${d}" stroke="var(--_node-stroke)" stroke-width="${oe.innerBox}" />`);for(let u=0;u<l.length;u++){let s=l[u],f=d+u*c+c/2;h.push(Ho(s,n,f,t));}return l.length===0&&h.push(`<text x="${n+t/2}" y="${d+c/2}" text-anchor="middle" dy="${de}" font-size="${Me.attrSize}" fill="var(--_text-faint)" font-style="italic">(no attributes)</text>`),h.join(`
`)}function Ho(e,n,r,t){let o=[],i=0;if(e.keys.length>0){let l=e.keys.join(",");i=ae(l,Me.keySize,Me.keyWeight)+8,o.push(`<rect x="${n+6}" y="${r-7}" width="${i}" height="14" rx="2" ry="2" fill="var(--_key-badge)" />`),o.push(`<text x="${n+6+i/2}" y="${r}" text-anchor="middle" dy="${de}" font-size="${Me.keySize}" font-weight="${Me.keyWeight}" fill="var(--_text-sec)">${e.keys.join(",")}</text>`);}let c=n+8+(i>0?i+6:0);o.push(`<text x="${c}" y="${r}" class="mono" dy="${de}" font-size="${Me.attrSize}" font-weight="${Me.attrWeight}"><tspan fill="var(--_text-muted)">${ft(e.type)}</tspan></text>`);let a=n+t-8;return o.push(`<text x="${a}" y="${r}" class="mono" text-anchor="end" dy="${de}" font-size="${Me.attrSize}" font-weight="${Me.attrWeight}"><tspan fill="var(--_text-sec)">${ft(e.name)}</tspan></text>`),o.join(`
`)}function Yo(e){if(e.points.length<2)return "";let n=e.points.map(t=>`${t.x},${t.y}`).join(" "),r=e.identifying?"":' stroke-dasharray="6 4"';return `<polyline points="${n}" fill="none" stroke="var(--_line)" stroke-width="${oe.connector}"${r} />`}function Xo(e){if(!e.label||e.points.length<2)return "";let n=jo(e.points),t=ae(e.label,Z.edgeLabel,Q.edgeLabel)+8,o=Z.edgeLabel+6;return `<rect x="${n.x-t/2}" y="${n.y-o/2}" width="${t}" height="${o}" rx="2" ry="2" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${n.x}" y="${n.y}" text-anchor="middle" dy="${de}" font-size="${Z.edgeLabel}" font-weight="${Q.edgeLabel}" fill="var(--_text-muted)">${ft(e.label)}</text>`}function Bo(e){if(e.points.length<2)return "";let n=[],r=e.points[0],t=e.points[1];n.push(zn(r,t,e.cardinality1));let o=e.points[e.points.length-1],i=e.points[e.points.length-2];return n.push(zn(o,i,e.cardinality2)),n.join(`
`)}function zn(e,n,r){let t=[],o=oe.connector+.25,i=e.x-n.x,c=e.y-n.y,a=Math.sqrt(i*i+c*c);if(a===0)return "";let l=i/a,h=c/a,d=-h,u=l,s=e.x-l*4,f=e.y-h*4,p=e.x-l*16,x=e.y-h*16,g=r==="one"||r==="zero-one",m=r==="many"||r==="zero-many",v=r==="zero-one"||r==="zero-many";if(g){t.push(`<line x1="${s+d*6}" y1="${f+u*6}" x2="${s-d*6}" y2="${f-u*6}" stroke="var(--_line)" stroke-width="${o}" />`);let M=s-l*4,L=f-h*4;t.push(`<line x1="${M+d*6}" y1="${L+u*6}" x2="${M-d*6}" y2="${L-u*6}" stroke="var(--_line)" stroke-width="${o}" />`);}if(m){let M=s,L=f;t.push(`<line x1="${M+d*7}" y1="${L+u*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),t.push(`<line x1="${M}" y1="${L}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),t.push(`<line x1="${M-d*7}" y1="${L-u*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`);}if(v){let $=m?20:12,M=e.x-l*$,L=e.y-h*$;t.push(`<circle cx="${M}" cy="${L}" r="4" fill="var(--bg)" stroke="var(--_line)" stroke-width="${o}" />`);}return t.join(`
`)}function jo(e){if(e.length===0)return {x:0,y:0};if(e.length===1)return e[0];let n=0;for(let o=1;o<e.length;o++){let i=e[o].x-e[o-1].x,c=e[o].y-e[o-1].y;n+=Math.sqrt(i*i+c*c);}if(n===0)return e[0];let r=n/2,t=0;for(let o=1;o<e.length;o++){let i=e[o].x-e[o-1].x,c=e[o].y-e[o-1].y,a=Math.sqrt(i*i+c*c);if(t+a>=r){let l=a>0?(r-t)/a:0;return {x:e[o-1].x+i*l,y:e[o-1].y+c*l}}t+=a;}return e[e.length-1]}function ft(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Fo(e){let n=e.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(n)?"sequence":/^classdiagram\s*$/.test(n)?"class":/^erdiagram\s*$/.test(n)?"er":"flowchart"}function zo(e){return {bg:e.bg??Oe.bg,fg:e.fg??Oe.fg,line:e.line,accent:e.accent,muted:e.muted,surface:e.surface,border:e.border}}async function Un(e,n={}){let r=zo(n),t=n.font??"Geist",o=n.transparent??false,i=Fo(e),c=e.split(/[\n;]/).map(a=>a.trim()).filter(a=>a.length>0&&!a.startsWith("%%"));switch(i){case "sequence":{let a=nt(c),l=On(a,n);return Wn(l,r,t,o)}case "class":{let a=rt(c),l=await Yn(a,n);return jn(l,r,t,o)}case "er":{let a=ot(c),l=await Fn(a,n);return Vn(l,r,t,o)}default:{let a=Fe(e),l=await gn(a,n),h=En(n.animate);return Dn(l,r,t,o,n,h)}}}typeof window<"u"&&(window.__mermaid={renderMermaid:Un,renderMermaidAscii:Et,THEMES:pt,DEFAULTS:Oe,fromShikiTheme:gt});exports.DEFAULTS=Oe;exports.THEMES=pt;exports.fromShikiTheme=gt;exports.renderMermaid=Un;exports.renderMermaidAscii=Et;return exports;})({});//# sourceMappingURL=beautiful-mermaid.browser.global.js.map
//# sourceMappingURL=beautiful-mermaid.browser.global.js.map